backtest:
  aggregate_out_prefix: ./results/aggregate_csv_1year
  commission_rate: 0.0005
  slippage_rate: 0.001
  starting_balance: 10000.0
  trade_log_csv: ./results/trade_log_csv_1year.csv
data:
  api_key: ${BITBANK_API_KEY}
  api_secret: ${BITBANK_API_SECRET}
  ccxt_options:
    enableRateLimit: true
    rateLimit: 20000
    timeout: 60000
    verbose: false
  exchange: bitbank
  exponential_backoff: true
  fetch_retries: 3
  limit: 400
  paginate: true
  per_page: 200
  since_hours: 96
  symbol: BTC/JPY
  timeframe: 1h
  weekend_data: true
  weekend_extension_hours: 72
ml:
  calibration:
    cv: prefit
    method: sigmoid
  ensemble:
    base_models:
    - bagging_fraction: 0.8
      lambda_l1: 0.5
      lambda_l2: 0.5
      learning_rate: 0.1
      max_depth: 8
      n_estimators: 100
      type: lgbm
    - max_depth: 8
      min_samples_leaf: 2
      min_samples_split: 5
      n_estimators: 100
      type: rf
    - colsample_bytree: 0.8
      learning_rate: 0.1
      max_depth: 6
      n_estimators: 100
      subsample: 0.8
      type: xgb
    enabled: true
    method: stacking
    weights:
    - 0.4
    - 0.3
    - 0.3
  extra_features:
  - rsi_14
  - macd
  - rci_9
  - volume_zscore
  - sma_200
  - ema_50
  - stoch
  - bb
  - adx
  - willr
  - cmf
  - fisher
  - vix
  - dxy
  - fear_greed
  - funding
  - day_of_week
  - hour_of_day
  - mochipoyo_long_signal
  - mochipoyo_short_signal
  - sma_50
  - sma_10
  - ema_12
  - ema_26
  - sma_20
  - ema_20
  - momentum_14
  - trend_strength
  feat_period: 14
  horizon: 5
  lags:
  - 1
  - 2
  - 3
  - 4
  - 5
  - 6
  - 7
  - 8
  - 9
  - 10
  - 11
  - 12
  model_params:
    bagging_fraction: 0.8
    lambda_l1: 0.5
    lambda_l2: 0.5
    learning_rate: 0.1
    max_depth: 8
    n_estimators: 100
  model_type: lgbm
  optuna:
    direction: maximize
    n_trials: 5
    pruner:
      interval_steps: 1
      n_startup_trials: 3
      n_warmup_steps: 5
      name: MedianPruner
    sampler:
      name: TPESampler
    timeout: 180
  rolling_window: 20
  target_type: classification
  vix_integration:
    enabled: true
    panic_threshold: 35
    risk_off_threshold: 25
    spike_multiplier: 2.0
monitoring:
  check_interval: 300
  enabled: true
  metrics:
  - total_return
  - sharpe_ratio
  - max_drawdown
  - win_rate
  - profit_factor
  - calmar_ratio
risk:
  dynamic_position_sizing:
    enabled: true
    formula: linear
  kelly_criterion:
    enabled: true
    lookback_window: 50
    max_fraction: 0.25
    min_trades_required: 10
  risk_per_trade: 0.02
  stop_atr_mult: 2.0
strategy:
  name: ml
  params:
    atr_multiplier: 0.5
    model_path: models/production/perfect_127_features_model.pkl
    threshold: 0.05
    threshold_bounds:
    - 0.01
    - 0.25
    thresholds_to_test:
    - 0.02
    - 0.05
    - 0.08
    - 0.1
    - 0.15
    volatility_adjustment: true
  type: single
walk_forward:
  step: 24
  test_window: 168
  train_window: 720
