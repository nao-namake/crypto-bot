# ========================================
# å‹•çš„é–¾å€¤è¨­å®šãƒ•ã‚¡ã‚¤ãƒ« (thresholds.yaml)
# ========================================
# ç›®çš„: MLçµ±åˆãƒ»ãƒªã‚¹ã‚¯ç®¡ç†ãƒ»æˆ¦ç•¥ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã®å‹•çš„é–¾å€¤ä¸€å…ƒç®¡ç†
#
# ã“ã®ãƒ•ã‚¡ã‚¤ãƒ«ã®å½¹å‰²:
#   1. MLçµ±åˆãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ï¼ˆä¿¡é ¼åº¦é–¾å€¤ãƒ»é‡ã¿ãƒ»ãƒœãƒ¼ãƒŠã‚¹/ãƒšãƒŠãƒ«ãƒ†ã‚£ï¼‰
#   2. å‹•çš„ä¿¡é ¼åº¦è¨ˆç®—ï¼ˆå¸‚å ´ä¸ç¢ºå®Ÿæ€§èª¿æ•´ãƒ»æˆ¦ç•¥åˆ¥ä¿¡é ¼åº¦ç¯„å›²ï¼‰
#   3. æˆ¦ç•¥ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ï¼ˆ5æˆ¦ç•¥ã®é–¾å€¤ãƒ»ä¿¡é ¼åº¦è¨ˆç®—ï¼‰
#   4. ãƒªã‚¹ã‚¯ç®¡ç†è¨­å®šï¼ˆKellyåŸºæº–ãƒ»ãƒ‰ãƒ­ãƒ¼ãƒ€ã‚¦ãƒ³ãƒ»è¨¼æ‹ é‡‘ç¶­æŒç‡ï¼‰
#   5. ãƒã‚¸ã‚·ãƒ§ãƒ³ç®¡ç†è¨­å®šï¼ˆTP/SLãƒ»ç·Šæ€¥æ±ºæ¸ˆï¼‰
#   6. Optunaæœ€é©åŒ–ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ï¼ˆPhase 40æœ€é©åŒ–çµæœï¼‰
#
# è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«åˆ†é›¢:
#   - features.yaml: æ©Ÿèƒ½ã‚ªãƒ³ã‚ªãƒ•
#   - unified.yaml: åŸºæœ¬è¨­å®šï¼ˆexchangeã€modeç­‰ï¼‰
#   - thresholds.yaml: å‹•çš„é–¾å€¤ï¼ˆã“ã®ãƒ•ã‚¡ã‚¤ãƒ«ï¼‰
#   - feature_order.json: ç‰¹å¾´é‡å®šç¾©
#
# ä½¿ç”¨æ–¹æ³•:
#   - get_threshold()é–¢æ•°ã§å‹•çš„ã«å‚ç…§ï¼ˆãƒãƒ¼ãƒ‰ã‚³ãƒ¼ãƒ‰ç¦æ­¢ï¼‰
#   - Optunaæœ€é©åŒ–: scripts/optimization/run_phase40_optimization.py
#
# ========================================

# ========================================
# å®Ÿè¡Œè¨­å®šï¼ˆExecution Settingsï¼‰
# ========================================
execution:
  backtest_period_days: 30
  live_mode_interval_seconds: 300
  paper_mode_interval_seconds: 300

# ========================================
# ãƒãƒƒã‚¯ãƒ†ã‚¹ãƒˆè¨­å®šï¼ˆBacktest Settingsï¼‰
# ========================================
backtest:
  log_level: WARNING
  discord_enabled: false
  progress_interval: 1000
  report_interval: 10000
  mock_api_calls: true
  enable_detailed_logging: false
  fast_data_slicing: true

# ========================================
# ğŸ¤– MLçµ±åˆè¨­å®šï¼ˆML Integration Settingsï¼‰
# ========================================
# Phase 41.8.5æœ€é©åŒ–å®Œäº†:
#   - min_ml_confidence: 0.45ï¼ˆ3ã‚¯ãƒ©ã‚¹åˆ†é¡å¯¾å¿œï¼‰
#   - high_confidence_threshold: 0.60ï¼ˆ3ã‚¯ãƒ©ã‚¹åˆ†é¡å¯¾å¿œï¼‰
#   - MLçµ±åˆç‡100%é”æˆï¼ˆ10%â†’100%æ”¹å–„ï¼‰
#   - 3æ®µéšçµ±åˆãƒ­ã‚¸ãƒƒã‚¯ï¼ˆ<0.45: æˆ¦ç•¥ã®ã¿ãƒ»0.45-0.60: åŠ é‡å¹³å‡ãƒ»â‰¥0.60: ãƒœãƒ¼ãƒŠã‚¹/ãƒšãƒŠãƒ«ãƒ†ã‚£ï¼‰
# ========================================
ml:
  confidence_threshold: 0.3
  allow_dummy_fallback: false
  default_confidence: 0.5
  strategy_integration:
    enabled: true
    ml_weight: 0.35
    strategy_weight: 0.7
    high_confidence_threshold: 0.6
    agreement_bonus: 1.2
    disagreement_penalty: 0.85
    min_ml_confidence: 0.45
    hold_conversion_threshold: 0.4
  # Meta-Learningå‹•çš„é‡ã¿æœ€é©åŒ–ã‚·ã‚¹ãƒ†ãƒ 
  meta_learning:
    enabled: false  # ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆç„¡åŠ¹ï¼ˆæ…é‡ãªæ®µéšçš„æœ‰åŠ¹åŒ–ï¼‰
    model_path: "models/meta_learning/meta_model.pkl"
    # ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯å›ºå®šé‡ã¿ï¼ˆMeta-MLå¤±æ•—æ™‚ä½¿ç”¨ï¼‰
    fallback_ml_weight: 0.35
    fallback_strategy_weight: 0.7
    # Meta-MLäºˆæ¸¬ä¿¡é ¼åº¦é–¾å€¤
    min_confidence: 0.3
    # å¸‚å ´çŠ¶æ³ç‰¹å¾´é‡è¨­å®š
    market_features:
      # ãƒœãƒ©ãƒ†ã‚£ãƒªãƒ†ã‚£é–¢é€£
      atr_window: 14
      bb_window: 20
      volatility_ratio_window: 7
      # ãƒˆãƒ¬ãƒ³ãƒ‰é–¢é€£
      ema_short: 20
      ema_long: 50
      adx_window: 14
      trend_strength_threshold: 0.5
      # ãƒ¬ãƒ³ã‚¸åˆ¤å®šé–¢é€£
      donchian_window: 20
      range_threshold: 0.02
    # ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãƒˆãƒ©ãƒƒã‚­ãƒ³ã‚°è¨­å®š
    performance_tracking:
      window_days_short: 7
      window_days_long: 30
      min_trades_required: 5
      history_file: "src/core/state/performance_history.json"
    # Meta-MLãƒ¢ãƒ‡ãƒ«è¨­å®š
    model_config:
      n_estimators: 100
      learning_rate: 0.05
      max_depth: 5
      random_state: 42
  dynamic_confidence:
    base_hold: 0.35
    error_fallback: 0.25
    ml_fallback: 0.35
    neutral_default: 0.4
    strategy_fallback: 0.35
dynamic_confidence:
  market_uncertainty:
    volatility_factor_max: 0.1
    volatility_divisor: 1.0
    volume_factor_max: 0.06
    volume_multiplier: 0.2
    price_factor_max: 0.04
    uncertainty_max: 0.2
    uncertainty_boost: 1.0
  strategies:
    mochipoy_alert:
      buy_strong_base: 0.7
      buy_strong_max: 0.70
      buy_weak_base: 0.45
      buy_weak_max: 0.6
      sell_strong_base: 0.7
      sell_strong_max: 0.70
      sell_weak_base: 0.45
      sell_weak_max: 0.6
      hold_base: 0.2
      hold_min: 0.1
      hold_max: 0.35
    multi_timeframe:
      agreement_base: 0.75
      agreement_min: 0.7
      agreement_max: 1.0
      single_tf_base: 0.55
      single_tf_min: 0.4
      single_tf_max: 0.75
      disagreement_base: 0.15
      disagreement_min: 0.1
      disagreement_max: 0.3
      weighted_min: 0.35
      weighted_max: 1.0
      tf_4h_min_strength: 0.002
      tf_4h_weight: 0.6
      tf_15m_weight: 0.4
      position_size_base: 0.025
      atr_ratio_threshold: 0.005
      price_breakout_ratio: 0.995
    donchian_channel:
      breakout_base: 0.6
      breakout_min: 0.3
      breakout_max: 0.85
      reversal_base: 0.5
      reversal_min: 0.3
      reversal_max: 0.7
      hold_base: 0.4
      hold_min: 0.35
      hold_max: 0.6
      volume_bonus_max: 0.1
      volume_multiplier: 0.2
    adx_trend:
      strong_base: 0.65
      strong_min: 0.4
      strong_max: 0.85
      moderate_base: 0.5
      moderate_min: 0.35
      moderate_max: 0.7
      weak_base: 0.35
      weak_min: 0.25
      weak_max: 0.5
      hold_base: 0.45
      hold_min: 0.35
      hold_max: 0.6
      default_min: 0.25
      default_max: 0.6
      adx_bonus_max: 0.25
      adx_divisor: 25
      di_bonus_max: 0.15
      di_divisor: 12
      volume_bonus_max: 0.1
      volume_multiplier: 0.15
    atr_based:
      high_volatility_base: 0.55
      high_volatility_min: 0.35
      high_volatility_max: 0.8
      normal_volatility_base: 0.45
      normal_volatility_min: 0.3
      normal_volatility_max: 0.65
      low_volatility_base: 0.35
      low_volatility_min: 0.25
      low_volatility_max: 0.5
      rsi_base: 0.2
      rsi_multiplier: 0.3
      agreement_max: 0.85
      weak_base: 0.08
      weak_multiplier: 0.1
      volatility_bonus: 1.02
      volatility_max: 0.85
      position_size_base: 0.015
      market_stress_threshold: 0.7
      min_atr_ratio: 0.5
      strength_divisor: 0.2
      strength_normalize: 30.0
  emergency_stop_on_dummy: true
  max_model_failures: 3
  prediction_fallback_confidence: 0.0
  dummy_confidence: 0.5
  model_paths:
    base_path: /app
    local_path: .
    training_path: models/training

# ========================================
# ğŸ“Š å‹•çš„ä¿¡é ¼åº¦è¨ˆç®—ï¼ˆDynamic Confidence Calculationï¼‰
# ========================================
# å¸‚å ´ä¸ç¢ºå®Ÿæ€§ã«åŸºã¥ãä¿¡é ¼åº¦èª¿æ•´ãƒ»æˆ¦ç•¥åˆ¥ä¿¡é ¼åº¦ç¯„å›²è¨­å®š
# ========================================
performance:
  default_latency_ms: 100.0

# ========================================
# ğŸ¯ å‹•çš„æˆ¦ç•¥é¸æŠè¨­å®šï¼ˆDynamic Strategy Selectionï¼‰
# ========================================
# Phase 51.5-A: 3æˆ¦ç•¥æ§‹æˆæœ€é©åŒ–ï¼ˆMochipoyAlertãƒ»MultiTimeframeå‰Šé™¤ï¼‰
#
# ç›®çš„: å¸‚å ´ãƒ¬ã‚¸ãƒ¼ãƒ ï¼ˆtight_range/normal_range/trending/high_volatilityï¼‰ã«å¿œã˜ã¦
#       æˆ¦ç•¥ã®é‡ã¿ã‚’å‹•çš„ã«å¤‰æ›´ã—ã€ãƒ¬ã‚¸ãƒ¼ãƒ ç‰¹æ€§ã«æœ€é©åŒ–ã•ã‚ŒãŸæˆ¦ç•¥é¸æŠã‚’å®Ÿç¾
#
# è¨­å®šæ–¹æ³•:
#   - ãƒ¬ã‚¸ãƒ¼ãƒ å: tight_range, normal_range, trending, high_volatility
#   - æˆ¦ç•¥å: ATRBased, DonchianChannel, ADXTrendStrengthï¼ˆ3æˆ¦ç•¥ï¼‰
#   - é‡ã¿: 0.0-1.0ï¼ˆåˆè¨ˆ1.0ã«ãªã‚‹ã‚ˆã†ã«è¨­å®šï¼‰
#   - high_volatility: å…¨æˆ¦ç•¥ç„¡åŠ¹åŒ–ï¼ˆç©ºè¾æ›¸ {}ï¼‰
# ========================================
dynamic_strategy_selection:
  enabled: true
  # ãƒ¬ã‚¸ãƒ¼ãƒ åˆ¥æˆ¦ç•¥é‡ã¿ãƒãƒƒãƒ”ãƒ³ã‚°
  # Phase 51.5-A: 3æˆ¦ç•¥æ§‹æˆã«æœ€é©åŒ–ï¼ˆrangeå‹2ãƒ»trendå‹1ï¼‰
  regime_strategy_mapping:
    tight_range:  # ç‹­ã„ãƒ¬ãƒ³ã‚¸ç›¸å ´ï¼ˆBBå¹… < 3%, ä¾¡æ ¼å¤‰å‹• < 2%ï¼‰
      ATRBased: 0.70            # ãƒ¬ãƒ³ã‚¸æ¤œå‡ºåŠ›ãŒé«˜ã„ãƒ»ãƒœãƒ©ãƒ†ã‚£ãƒªãƒ†ã‚£ãƒ™ãƒ¼ã‚¹åˆ¤æ–­
      DonchianChannel: 0.30      # ãƒ–ãƒ¬ã‚¤ã‚¯ã‚¢ã‚¦ãƒˆæ¤œå‡º
      ADXTrendStrength: 0.0      # ä½¿ç”¨ã—ãªã„ï¼ˆãƒˆãƒ¬ãƒ³ãƒ‰å°‚ç”¨ï¼‰
    normal_range:  # é€šå¸¸ãƒ¬ãƒ³ã‚¸ç›¸å ´ï¼ˆBBå¹… < 5%, ADX < 20ï¼‰
      ATRBased: 0.50
      DonchianChannel: 0.30
      ADXTrendStrength: 0.20     # å¼±ãƒˆãƒ¬ãƒ³ãƒ‰æ¤œå‡º
    trending:  # ãƒˆãƒ¬ãƒ³ãƒ‰ç›¸å ´ï¼ˆADX > 25, EMAå‚¾ã > 1%ï¼‰
      ADXTrendStrength: 0.60     # å¼·ãƒˆãƒ¬ãƒ³ãƒ‰æ¤œå‡ºï¼ˆä¸»åŠ›ï¼‰
      ATRBased: 0.30            # ãƒˆãƒ¬ãƒ³ãƒ‰ç›¸å ´ã§ã‚‚å¯¾å¿œå¯èƒ½
      DonchianChannel: 0.10      # ãƒˆãƒ¬ãƒ³ãƒ‰æ–¹å‘ãƒ–ãƒ¬ã‚¤ã‚¯ã‚¢ã‚¦ãƒˆ
    high_volatility:  # é«˜ãƒœãƒ©ãƒ†ã‚£ãƒªãƒ†ã‚£ï¼ˆATRæ¯” > 1.8%ãƒ»4æ™‚é–“è¶³ï¼‰
      # å…¨æˆ¦ç•¥ç„¡åŠ¹åŒ–ï¼ˆå¾…æ©Ÿãƒ¢ãƒ¼ãƒ‰ï¼‰
      ATRBased: 0.0
      DonchianChannel: 0.0
      ADXTrendStrength: 0.0

# ========================================
# ğŸ¯ æˆ¦ç•¥ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ï¼ˆStrategy Parametersï¼‰
# ========================================
# 5æˆ¦ç•¥ã®é–¾å€¤ãƒ»ä¿¡é ¼åº¦è¨ˆç®—è¨­å®š
# ========================================
strategies:
  adx_trend:
    di_crossover_threshold: 0.5
    di_weak_signal_confidence: 0.35
    hold_confidence: 0.45
    min_confidence: 0.25
    moderate_trend_max: 25
    moderate_trend_min: 15
    strong_trend_threshold: 25
    weak_di_threshold: 1.0
    weak_trend_threshold: 15
  atr_based:
    bb_overbought: 0.7
    bb_oversold: 0.3
    high_volatility_strength: 0.5
    hold_confidence: 0.15
    low_volatility_strength: 0.2
    min_confidence: 0.25
    normal_volatility_strength: 0.25
    rsi_overbought: 65
    rsi_oversold: 35
    strength_fallback: 0.3
    base_confidence: 0.25
    confidence_multiplier: 0.3
  donchian_channel:
    breakout_threshold: 0.002
    hold_confidence: 0.4
    middle_zone_max: 0.6
    middle_zone_min: 0.4
    min_confidence: 0.25
    reversal_threshold: 0.05
    weak_signal_confidence: 0.35
    weak_signal_max: 0.75
    weak_signal_min: 0.25
  mochipoy_alert:
    hold_confidence: 0.15
    weak_signal_confidence: 0.4
  multi_timeframe:
    hold_confidence: 0.15
    trend_conflict_confidence: 0.3

# ========================================
# ğŸ’¹ å–å¼•è¨­å®šï¼ˆTrading Settingsï¼‰
# ========================================
# å–å¼•å®Ÿè¡Œãƒ»ä¿¡é ¼åº¦ãƒ¬ãƒ™ãƒ«ãƒ»KellyåŸºæº–è¨­å®š
# ========================================
trading:
  anomaly:
    spread_critical_threshold: 0.005
    spread_warning_threshold: 0.003
  ask_spread_ratio: 1.001
  bid_spread_ratio: 0.999
  confidence_levels:
    high: 0.45
    low: 0.2
    medium: 0.3
    min_ml: 0.12
    very_high: 0.6
  fallback_btc_jpy: 16500000.0
  fallback_prices:
    ask: 16600000.0
    bid: 16400000.0
    default_ask: 16100000.0
    default_bid: 15900000.0
  kelly_criterion:
    min_trades_for_kelly: 5
    max_position_ratio: 0.03
    safety_factor: 0.7
  min_trade_size: 0.0001
  initial_position_size: 0.0001
  fee_rate: 0.0012
  minimum_live_balance: 3000
  position_sizing:
    max_position_ratio: 0.05
    stop_loss_atr_multiplier: 1.2
    stop_loss_rate: 0.02
    take_profit_rate: 0.04
    take_profit_ratio: 2.0
  risk_thresholds:
    conditional: 0.65
    deny: 0.85
    min_ml_confidence: 0.12
  stats_log_interval: 10

# ========================================
# ğŸ§  ã‚¢ãƒ³ã‚µãƒ³ãƒ–ãƒ«ãƒ¢ãƒ‡ãƒ«è¨­å®šï¼ˆEnsemble Model Settingsï¼‰
# ========================================
ensemble:
  max_nan_ratio_features: 0.5
  max_nan_ratio_target: 0.3
  min_training_samples: 50

# ========================================
# ğŸ“ˆ MLãƒ¢ãƒ‡ãƒ«è¨­å®šï¼ˆML Model Settingsï¼‰
# ========================================
# LightGBMãƒ»XGBoostãƒ»RandomForestãƒã‚¤ãƒ‘ãƒ¼ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿
# ========================================
models:
  lgbm:
    num_leaves: 31
    learning_rate: 0.05
    n_estimators: 100
    feature_fraction: 0.9
    bagging_fraction: 0.8
    bagging_freq: 5
    max_depth: -1
    min_child_samples: 20
    reg_alpha: 0.0
    reg_lambda: 0.0
  min_training_samples: 10
  rf:
    n_estimators: 100
    max_depth: 10
    min_samples_split: 5
    min_samples_leaf: 2
    max_features: sqrt
    bootstrap: true
    oob_score: true
    class_weight: balanced
  xgb:
    max_depth: 6
    learning_rate: 0.05
    n_estimators: 100
    min_child_weight: 1
    subsample: 0.8
    colsample_bytree: 0.8
    alpha: 0
    lambda: 1
    gamma: 0

# ========================================
# ğŸ“Š ãƒ¬ãƒãƒ¼ãƒˆè¨­å®šï¼ˆReporting Settingsï¼‰
# ========================================
reporting:
  base_dir: logs/reports
  paper_trading_dir: logs/paper_trading_reports

# ========================================
# âš–ï¸ ãƒªã‚¹ã‚¯ç®¡ç†è¨­å®šï¼ˆRisk Management Settingsï¼‰
# ========================================
# KellyåŸºæº–ãƒ»ãƒ‰ãƒ­ãƒ¼ãƒ€ã‚¦ãƒ³ãƒ»è³‡é‡‘ç®¡ç†è¨­å®š
# ========================================
risk:
  emergency_ratio: 0.005
  emergency_stop_ratio: 0.98
  fallback_max_ratio: 0.1
  fallback_min_ratio: 0.01
  fallback_stop_ratio: 0.95
  kelly_lookback_days: 30
  recent_lookback_hours: 24
  safe_balance_ratio: 0.3
  max_capital_usage: 0.3
  reserve_ratio: 0.7

# ========================================
# ğŸ“ˆ ãƒã‚¸ã‚·ãƒ§ãƒ³ç®¡ç†è¨­å®šï¼ˆPosition Management Settingsï¼‰
# ========================================
# Phase 49.18å®Œäº†ï¼ˆãƒ‡ã‚¤ãƒˆãƒ¬ãƒ¼ãƒ‰ç‰¹åŒ–è¨­å®šï¼‰:
#   - SL 1.5%ãƒ»TP 1.0%ãƒ»RRæ¯”0.67:1ï¼ˆç´°ã‹ãåˆ©ç¢ºãƒ»ãƒ‡ã‚¤ãƒˆãƒ¬ãƒ¼ãƒ‰æœ€é©åŒ–ï¼‰
#   - Phase 46: å€‹åˆ¥TP/SLå®Ÿè£…ï¼ˆãƒ‡ã‚¤ãƒˆãƒ¬ãƒ¼ãƒ‰ç‰¹åŒ–ãƒ»ã‚·ãƒ³ãƒ—ãƒ«å®Ÿè£…ï¼‰
#   - Phase 49.18: è¨¼æ‹ é‡‘ç¶­æŒç‡80%ç¢ºå®Ÿéµå®ˆï¼ˆcritical: 100.0 â†’ 80.0å¤‰æ›´ï¼‰
#   - Phase 50.5: SLæ³¨æ–‡ä¿è­·ï¼ˆã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—æ©Ÿèƒ½ä¸€æ™‚ç„¡åŠ¹åŒ–ï¼‰
# ========================================
position_management:
  # Phase 46: å€‹åˆ¥TP/SLå®Ÿè£…ï¼ˆPhase 42çµ±åˆTP/SLå‰Šé™¤æ¸ˆã¿ï¼‰
  min_account_balance: 10000
  max_open_positions: 3
  max_daily_trades: 50
  cooldown_minutes: 15
  min_trade_size: 0.0001
  max_position_ratio_per_trade:
    low_confidence: 0.03
    medium_confidence: 0.05
    high_confidence: 0.1
    enforce_minimum: true
  dynamic_position_sizing:
    enabled: true
    low_confidence:
      min_ratio: 0.01
      max_ratio: 0.03
    medium_confidence:
      min_ratio: 0.03
      max_ratio: 0.05
    high_confidence:
      min_ratio: 0.05
      max_ratio: 0.1
  account_size_adjustments:
    small:
      threshold: 50000
      min_trade_override: true
    medium:
      threshold: 100000
      position_multiplier: 1.0
    large:
      threshold: 100001
      position_multiplier: 1.0
  emergency_stop_loss:
    enable: true
    price_change_threshold: 0.03
    time_window_minutes: 5
    max_loss_threshold: 0.05
    override_cooldown: true
    min_hold_minutes: 1
  take_profit:
    enabled: true
    default_ratio: 0.67              # Phase 49.18: RRæ¯”0.67:1ï¼ˆTP 1.0% / SL 1.5%ï¼‰
    min_profit_ratio: 0.01          # Phase 49.18: TP 1.0%ï¼ˆç¾å®Ÿçš„ãªåˆ©ç¢ºãƒ©ã‚¤ãƒ³ãƒ»2-3æ™‚é–“åˆ°é”ï¼‰
    override_strategy_tp: false
    position_partial_exit: false
  stop_loss:
    enabled: true
    default_atr_multiplier: 2.0
    max_loss_ratio: 0.015           # Phase 49.18: SL 1.5%
    override_strategy_sl: false
    enable_trailing: false
    execution_slippage: 0.003
    adaptive_atr:
      enabled: true
      use_15m_timeframe: true
      volatility_lookback: 20
      low_volatility:
        threshold_ratio: 0.7
        multiplier: 2.5
      normal_volatility:
        multiplier: 2.0
      high_volatility:
        threshold_ratio: 1.3
        multiplier: 1.5
    min_distance:
      enabled: true
      ratio: 0.015
      override_atr: false
      min_atr_multiplier: 1.5
    trailing:
      enabled: false
      activation_profit: 0.02
      trailing_percent: 0.03
      min_update_distance: 200
      min_profit_lock: 0.005
      cancel_tp_when_exceeds: true

# ========================================
# ğŸ’° è¨¼æ‹ é‡‘ç®¡ç†è¨­å®šï¼ˆMargin Management Settingsï¼‰
# ========================================
# Phase 49.18å®Œäº†: ç¶­æŒç‡80%ç¢ºå®Ÿéµå®ˆï¼ˆcritical: 100.0 â†’ 80.0å¤‰æ›´ï¼‰
# ========================================
margin:
  position_value_estimation_ratio: 0.8
  # ç¶­æŒç‡é–¾å€¤ï¼ˆ80%ç¢ºå®Ÿéµå®ˆï¼‰
  thresholds:
    critical: 80.0
    warning: 100.0
    caution: 150.0
    safe: 200.0
  large_drop_threshold: 50.0
  min_position_value: 1000.0
  max_ratio_cap: 10000.0

# ========================================
# ğŸ“ æ³¨æ–‡å®Ÿè¡Œè¨­å®šï¼ˆOrder Execution Settingsï¼‰
# ========================================
# Phase 38.7.2å®Œäº†: å®Œå…¨æŒ‡å€¤ã‚ªãƒ³ãƒªãƒ¼å®Ÿè£…ï¼ˆ100%æŒ‡å€¤æ³¨æ–‡ï¼‰
# ========================================
order_execution:
  smart_order_enabled: true
  high_confidence_threshold: 0.0
  low_confidence_threshold: -1.0
  max_spread_ratio_for_limit: 0.005
  price_improvement_ratio: 0.0002
  entry_price_strategy: unfavorable
  guaranteed_execution_premium: 0.0005
  limit_order_timeout:
    enabled: true
    timeout_minutes: 5
    fallback_to_market: true
    max_price_deviation: 0.05
    check_interval_seconds: 60

# ========================================
# ğŸ”” æ®‹é«˜ã‚¢ãƒ©ãƒ¼ãƒˆè¨­å®šï¼ˆBalance Alert Settingsï¼‰
# ========================================
balance_alert:
  enabled: true
  min_required_margin: 14000.0
  alert_threshold_ratio: 1.2
  check_interval_minutes: 3
  discord_critical_alert: true

# ==================================================================================
# ğŸ”¬ Optunaæœ€é©åŒ–ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ï¼ˆPhase 40æœ€é©åŒ–çµæœï¼‰
# ==================================================================================
# ç›®çš„: Phase 40.1-40.4ã§æœ€é©åŒ–ã•ã‚ŒãŸ79ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã®æœ€é©å€¤
#
# é‡è¦:
#   1. ä¸Šè¨˜ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã¨ä¸€éƒ¨é‡è¤‡ã—ã¦ã„ã¾ã™
#   2. ã‚·ã‚¹ãƒ†ãƒ ã¯ä¸Šè¨˜ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã®å€¤ã‚’å„ªå…ˆä½¿ç”¨ã—ã¾ã™ï¼ˆget_threshold()å‚ç…§ï¼‰
#   3. ã“ã®ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã¯æœ€é©åŒ–çµæœã®è¨˜éŒ²ãƒ»å°†æ¥çš„ãªå‚ç…§ç”¨ã§ã™
#
# æœ€é©åŒ–å¯¾è±¡:
#   - Phase 40.1: ãƒªã‚¹ã‚¯ç®¡ç†ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ï¼ˆ12å€‹ï¼‰
#   - Phase 40.2: æˆ¦ç•¥ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ï¼ˆ30å€‹ï¼‰
#   - Phase 40.3: MLçµ±åˆãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ï¼ˆ7å€‹ï¼‰
#   - Phase 40.4: MLãƒã‚¤ãƒ‘ãƒ¼ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ï¼ˆ30å€‹ï¼‰
#
# æ›´æ–°æ–¹æ³•:
#   scripts/optimization/run_phase40_optimization.py ã‚’ä½¿ç”¨
#   Phase 40.5çµ±åˆãƒ‡ãƒ—ãƒ­ã‚¤ã§è‡ªå‹•æ›´æ–°ã•ã‚Œã¾ã™
#
# æœŸå¾…åŠ¹æœ:
#   +50-70%ã®åç›Šå‘ä¸Šï¼ˆãƒªã‚¹ã‚¯+10-15%ãƒ»æˆ¦ç•¥+15-20%ãƒ»MLçµ±åˆ+10-15%ãƒ»MLãƒã‚¤ãƒ‘ãƒ¼+15-20%ï¼‰
# ==================================================================================
donchian_breakout_base: 0.5
donchian_reversal_base: 0.4
donchian_weak_base: 0.25
donchian_breakout_threshold: 0.0015
donchian_reversal_threshold: 0.09
adx_strong_base: 0.7000000000000001
adx_moderate_base: 0.45
adx_weak_base: 0.3
adx_strong_threshold: 23
adx_moderate_min: 10
adx_di_crossover: 0.6000000000000001
adx_di_confirmation: 0.4
atr_high_vol_base: 0.55
atr_normal_vol_base: 0.5
atr_low_vol_base: 0.4
atr_rsi_overbought: 63
atr_rsi_oversold: 26
atr_bb_overbought: 0.8
atr_bb_oversold: 0.35
ml_weight: 0.35
high_confidence_threshold: 0.85
agreement_bonus: 1.15
disagreement_penalty: 0.85
min_ml_confidence: 0.45
hold_conversion_threshold: 0.4
lgbm_num_leaves: 40
lgbm_learning_rate: 0.03842362394715147
lgbm_n_estimators: 200
lgbm_max_depth: 10
lgbm_max_depth_unlimited: true
lgbm_min_child_samples: 100
lgbm_feature_fraction: 0.65
lgbm_bagging_fraction: 0.8
lgbm_bagging_freq: 7
lgbm_reg_alpha: 4.9643553965532245e-05
lgbm_reg_lambda: 0.05302953797331255
xgb_max_depth: 8
xgb_learning_rate: 0.09229165545667654
xgb_n_estimators: 350
xgb_min_child_weight: 7
xgb_subsample: 0.9
xgb_colsample_bytree: 0.8
xgb_gamma: 4.5
xgb_alpha: 0.006691186940196909
xgb_lambda: 0.20681062974015182
xgb_scale_pos_weight: 0.9
rf_n_estimators: 200
rf_max_depth: 24
rf_max_depth_none: false
rf_min_samples_split: 18
rf_min_samples_leaf: 5
rf_max_features_type: sqrt
rf_max_features_float: 0.5
rf_max_leaf_nodes: 50
rf_max_leaf_nodes_none: true
rf_min_impurity_decrease: 0.06
rf_bootstrap: true
rf_oob_score: false
rf_class_weight: null
