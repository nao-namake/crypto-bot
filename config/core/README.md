# config/core/ - ã‚³ã‚¢è¨­å®šã‚·ã‚¹ãƒ†ãƒ 

**Phase 13å®Œäº†**: åŒ…æ‹¬çš„å•é¡Œè§£æ±ºãƒ»ãƒ¢ãƒ¼ãƒ‰è¨­å®šä¸€å…ƒåŒ–ãƒ»ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£å¼·åŒ–ãƒ»æœ¬ç•ªé‹ç”¨æº–å‚™å®Œäº†ã«ã‚ˆã‚Šã€å…¨ç’°å¢ƒå…±é€šã®åŸºæœ¬è¨­å®šã‚·ã‚¹ãƒ†ãƒ ãŒå®Œæˆ

## ğŸ¯ å½¹å‰²ãƒ»è²¬ä»»

å…¨ç’°å¢ƒï¼ˆpaper/liveï¼‰ã§å…±é€šã—ã¦ä½¿ç”¨ã•ã‚Œã‚‹åŸºæœ¬è¨­å®šã¨ã‚·ã‚¹ãƒ†ãƒ å®šç¾©ã‚’ç®¡ç†ã—ã¾ã™ã€‚ãƒ¢ãƒ¼ãƒ‰è¨­å®šä¸€å…ƒåŒ–ã‚·ã‚¹ãƒ†ãƒ ã®ä¸­æ ¸ã¨ã—ã¦ã€ç’°å¢ƒå¤‰æ•°ã¨ã‚³ãƒãƒ³ãƒ‰ãƒ©ã‚¤ãƒ³å¼•æ•°ã«ã‚ˆã‚‹å„ªå…ˆåº¦åˆ¶å¾¡ã‚’å®Ÿè£…ã—ã€å®‰å…¨ã‹ã¤åŠ¹ç‡çš„ãªè¨­å®šç®¡ç†ã‚’å®Ÿç¾ã—ã¾ã™ã€‚

## ğŸ“‚ ãƒ•ã‚¡ã‚¤ãƒ«æ§‹æˆ

```
core/
â”œâ”€â”€ README.md               # ã“ã®ãƒ•ã‚¡ã‚¤ãƒ«ï¼ˆPhase 13å®Œäº†ç‰ˆï¼‰
â”œâ”€â”€ base.yaml              # åŸºæœ¬è¨­å®šï¼ˆå…¨ç’°å¢ƒå…±é€šãƒ»ãƒ¢ãƒ¼ãƒ‰ä¸€å…ƒåŒ–å¯¾å¿œï¼‰
â””â”€â”€ feature_order.json     # ç‰¹å¾´é‡å®šç¾©ï¼ˆ12å€‹å³é¸ã‚·ã‚¹ãƒ†ãƒ ãƒ»Phase 3å®Œäº†ï¼‰
```

## ğŸ”§ ä¸»è¦æ©Ÿèƒ½ãƒ»å®Ÿè£…

### **base.yaml - åŸºæœ¬è¨­å®šã‚·ã‚¹ãƒ†ãƒ ï¼ˆãƒ¢ãƒ¼ãƒ‰ä¸€å…ƒåŒ–å¯¾å¿œï¼‰**

**ğŸ¯ 3å±¤å„ªå…ˆé †ä½ã«ã‚ˆã‚‹ãƒ¢ãƒ¼ãƒ‰åˆ¶å¾¡**:
1. **ã‚³ãƒãƒ³ãƒ‰ãƒ©ã‚¤ãƒ³å¼•æ•°**ï¼ˆæœ€å„ªå…ˆï¼‰: `python3 main.py --mode live`
2. **ç’°å¢ƒå¤‰æ•°**ï¼ˆä¸­å„ªå…ˆï¼‰: `export MODE=live`
3. **YAMLãƒ•ã‚¡ã‚¤ãƒ«**ï¼ˆãƒ‡ãƒ•ã‚©ãƒ«ãƒˆï¼‰: `mode: paper`

**ä¸»è¦è¨­å®šã‚«ãƒ†ã‚´ãƒª**:
```yaml
# ãƒ¢ãƒ¼ãƒ‰è¨­å®šï¼ˆä¸€å…ƒåŒ–å¯¾å¿œï¼‰
mode: paper  # ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆï¼šå®‰å…¨ãªä»®æƒ³å–å¼•

# å–å¼•æ‰€è¨­å®š
exchange:
  name: bitbank
  symbol: BTC/JPY
  rate_limit_ms: 30000

# æ©Ÿæ¢°å­¦ç¿’è¨­å®š  
ml:
  confidence_threshold: 0.35
  ensemble_enabled: true
  models: [lgbm, xgb, rf]

# ãƒªã‚¹ã‚¯ç®¡ç†è¨­å®š
risk:
  risk_per_trade: 0.01
  kelly_max_fraction: 0.03
  max_drawdown: 0.20

# ãƒ‡ãƒ¼ã‚¿å–å¾—è¨­å®š
data:
  timeframes: [15m, 4h]
  since_hours: 96
  cache_enabled: true
```

### **feature_order.json - 12å€‹å³é¸ç‰¹å¾´é‡ã‚·ã‚¹ãƒ†ãƒ **

**Phase 3å®Œäº†æˆæœ**:
- **å¤§å¹…å‰Šæ¸›**: 97å€‹â†’12å€‹ç‰¹å¾´é‡ï¼ˆ87.6%å‰Šæ¸›ï¼‰
- **ã‚«ãƒ†ã‚´ãƒªåˆ†é¡**: basic(3) + technical(6) + anomaly(3)
- **é‡è¦åº¦ç®¡ç†**: critical/high/medium/lowåˆ†é¡

**ç‰¹å¾´é‡æ§‹æˆ**:
```json
{
  "total_features": 12,
  "feature_categories": {
    "basic": ["close", "volume", "returns_1"],
    "technical": ["rsi_14", "macd", "atr_14", "bb_position", "ema_20", "ema_50"],
    "anomaly": ["zscore", "volume_ratio", "market_stress"]
  }
}
```

### **Phase 13çµ±åˆæ©Ÿèƒ½**
- **åŒ…æ‹¬çš„å•é¡Œè§£æ±º**: MochiPoyAlertStrategyåå‰çµ±ä¸€ãƒ»APIç’°å¢ƒå¤‰æ•°ä¿è­·
- **ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£å¼·åŒ–**: GCP Secret Managerçµ±åˆãƒ»å®Ÿã‚­ãƒ¼æµå‡ºé˜²æ­¢
- **å“è³ªä¿è¨¼**: 306ãƒ†ã‚¹ãƒˆ100%åˆæ ¼ãƒ»58.88%ã‚«ãƒãƒ¬ãƒƒã‚¸é”æˆ
- **æœ¬ç•ªé‹ç”¨å¯¾å¿œ**: 24æ™‚é–“ç¨¼åƒãƒ»è‡ªå‹•å–å¼•é–‹å§‹å¯èƒ½çŠ¶æ…‹

## ğŸ“ ä½¿ç”¨æ–¹æ³•ãƒ»ä¾‹

### **åŸºæœ¬çš„ãªè¨­å®šèª­ã¿è¾¼ã¿**
```python
from src.core.config import load_config

# ãƒ¢ãƒ¼ãƒ‰è¨­å®šä¸€å…ƒåŒ–å¯¾å¿œ
config = load_config('config/core/base.yaml', cmdline_mode='live')

# è¨­å®šå€¤å–å¾—
mode = config.mode  # å„ªå…ˆé †ä½ã«å¾“ã£ãŸæœ€çµ‚ãƒ¢ãƒ¼ãƒ‰
confidence = config.ml.confidence_threshold
risk_per_trade = config.risk.risk_per_trade
```

### **ãƒ¢ãƒ¼ãƒ‰åˆ¶å¾¡ã®å®Ÿä¾‹**
```bash
# 1. ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆï¼ˆpaperï¼‰
python3 main.py --config config/core/base.yaml

# 2. ç’°å¢ƒå¤‰æ•°å„ªå…ˆ
export MODE=live
python3 main.py --config config/core/base.yaml

# 3. ã‚³ãƒãƒ³ãƒ‰ãƒ©ã‚¤ãƒ³æœ€å„ªå…ˆ
python3 main.py --config config/core/base.yaml --mode live
# â†’ æœ€çµ‚çš„ã«liveãƒ¢ãƒ¼ãƒ‰ã§å®Ÿè¡Œ
```

### **ç‰¹å¾´é‡å®šç¾©ã®å‚ç…§**
```python
import json

with open('config/core/feature_order.json', 'r') as f:
    feature_order = json.load(f)

print(f"ä½¿ç”¨ç‰¹å¾´é‡æ•°: {feature_order['total_features']}")  # 12
print(f"å‰Šæ¸›ç‡: {feature_order['reduction_history']['phase3_reduction']['reduction_rate']}")  # 0.876
```

### **è¨­å®šç¶™æ‰¿ãƒ»æ‹¡å¼µ**
```yaml
# ä»–ã®ç’°å¢ƒè¨­å®šã§ã®ç¶™æ‰¿ä¾‹
<<: *base_config  # base.yamlã‚’åŸºåº•ã¨ã—ã¦

# ç’°å¢ƒå›ºæœ‰ã®è¨­å®šã‚’è¿½åŠ ãƒ»ä¸Šæ›¸ã
production:
  min_order_size: 0.0001
  max_order_size: 0.001
```

## âš ï¸ æ³¨æ„äº‹é …ãƒ»åˆ¶ç´„

### **ãƒ¢ãƒ¼ãƒ‰è¨­å®šã®é‡è¦æ€§**
- **ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆå®‰å…¨è¨­è¨ˆ**: base.yamlã¯`mode: paper`ã§å®‰å…¨
- **æœ¬ç•ªç§»è¡Œæ…é‡**: `MODE=live`è¨­å®šã¯ååˆ†ãªæ¤œè¨¼å¾Œ
- **ä¸€è²«æ€§ç¢ºä¿**: ã‚·ã‚¹ãƒ†ãƒ å…¨ä½“ã§å˜ä¸€Config.modeå‚ç…§
- **ãƒŸã‚¹ãƒˆãƒ¬ãƒ¼ãƒ‰é˜²æ­¢**: è¨­å®šä¸æ•´åˆã«ã‚ˆã‚‹äºˆæœŸã—ãªã„å‹•ä½œé˜²æ­¢

### **è¨­å®šå¤‰æ›´æ™‚ã®æ³¨æ„**
- **ä¸‹ä½äº’æ›æ€§**: æ—¢å­˜ç’°å¢ƒè¨­å®šã¸ã®å½±éŸ¿ç¢ºèªå¿…é ˆ
- **å…¨ç’°å¢ƒæ¤œè¨¼**: development/staging/productionå…¨ã¦ç¢ºèª
- **ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—**: å¤‰æ›´å‰ã®è¨­å®šä¿å­˜
- **æ®µéšçš„é©ç”¨**: é‡è¦ãªå¤‰æ›´ã¯æ®µéšçš„ã«é©ç”¨

### **ç‰¹å¾´é‡ã‚·ã‚¹ãƒ†ãƒ åˆ¶ç´„**
- **12å€‹å›ºå®š**: feature_order.jsonã§å®šç¾©ã•ã‚ŒãŸ12å€‹å³é¸ä½¿ç”¨
- **é †åºé‡è¦**: ç‰¹å¾´é‡ã®é †åºå¤‰æ›´ã¯äºˆæ¸¬æ€§èƒ½ã«å½±éŸ¿
- **å‹å®‰å…¨**: å„ç‰¹å¾´é‡ã®å®šç¾©æ¸ˆã¿å‹ãƒ»ç¯„å›²ã‚’éµå®ˆ

### **ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£è€ƒæ…®äº‹é …**
- **APIèªè¨¼**: base.yamlã«ã¯APIã‚­ãƒ¼è¨˜è¼‰ç¦æ­¢ï¼ˆç’°å¢ƒå¤‰æ•°ä½¿ç”¨ï¼‰
- **æ©Ÿå¯†æƒ…å ±**: å®Ÿéš›ã®èªè¨¼æƒ…å ±ã¯GCP Secret Managerç®¡ç†
- **è¨­å®šåˆ†é›¢**: æœ¬ç•ªç”¨æ©Ÿå¯†æƒ…å ±ã¨è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã®åˆ†é›¢

## ğŸ”— é–¢é€£ãƒ•ã‚¡ã‚¤ãƒ«ãƒ»ä¾å­˜é–¢ä¿‚

### **é‡è¦ãªå¤–éƒ¨ä¾å­˜**
- **`src/core/config.py`**: è¨­å®šèª­ã¿è¾¼ã¿ã‚·ã‚¹ãƒ†ãƒ ãƒ»3å±¤å„ªå…ˆåº¦å®Ÿè£…
- **`src/core/orchestrator.py`**: çµ±åˆã‚·ã‚¹ãƒ†ãƒ åˆ¶å¾¡ãƒ»è¨­å®šé©ç”¨
- **`main.py`**: ã‚¨ãƒ³ãƒˆãƒªãƒ¼ãƒã‚¤ãƒ³ãƒˆãƒ»ã‚³ãƒãƒ³ãƒ‰ãƒ©ã‚¤ãƒ³å¼•æ•°è§£æ
- **`.github/workflows/ci.yml`**: CI/CDãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ãƒ»ç’°å¢ƒå¤‰æ•°è¨­å®š

### **ç’°å¢ƒåˆ¥è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«**
- **`config/production/production.yaml`**: æœ¬ç•ªç’°å¢ƒè¨­å®šï¼ˆPhase 13æœ¬ç•ªé‹ç”¨ï¼‰
- **base.yamlã®modeè¨­å®š**: ãƒšãƒ¼ãƒ‘ãƒ¼ãƒˆãƒ¬ãƒ¼ãƒ‰ç’°å¢ƒåˆ¶å¾¡ï¼ˆãƒ‡ãƒ•ã‚©ãƒ«ãƒˆï¼‰
- **`config/development/`**: é–‹ç™ºç’°å¢ƒè¨­å®š
- **`config/staging/`**: ã‚¹ãƒ†ãƒ¼ã‚¸ãƒ³ã‚°ç’°å¢ƒè¨­å®š

### **ã‚·ã‚¹ãƒ†ãƒ çµ±åˆ**
- **GCP Secret Manager**: APIèªè¨¼æƒ…å ±å®‰å…¨ç®¡ç†
- **GitHub Actions**: ç’°å¢ƒå¤‰æ•°`MODE`è‡ªå‹•è¨­å®š
- **Cloud Run**: æœ¬ç•ªç¨¼åƒæ™‚ã®è¨­å®šé©ç”¨
- **pytest**: ãƒ†ã‚¹ãƒˆå®Ÿè¡Œæ™‚ã®è¨­å®šæ¤œè¨¼ï¼ˆ306ãƒ†ã‚¹ãƒˆå¯¾å¿œï¼‰

---

**é‡è¦**: ã“ã®ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã¯Phase 13å®Œäº†ã«ã‚ˆã‚Šã€åŒ…æ‹¬çš„å•é¡Œè§£æ±ºãƒ»ãƒ¢ãƒ¼ãƒ‰è¨­å®šä¸€å…ƒåŒ–ãƒ»ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£å¼·åŒ–ãŒå®Œæˆã—ãŸå…¨ç’°å¢ƒã®åŸºç›¤ã¨ãªã‚Šã¾ã™ã€‚è¨­å®šå¤‰æ›´æ™‚ã¯ç‰¹ã«æ…é‡ã«è¡Œã„ã€å…¨ç’°å¢ƒã§ã®å‹•ä½œç¢ºèªã‚’å®Ÿæ–½ã—ã¦ãã ã•ã„ã€‚