# =============================================================================
# 収益性検証バックテスト設定（低閾値・取引機会確保版）
# confidence_threshold = 0.35 で月60-100回取引目標達成設定
# =============================================================================

# ----------------------------------------------------------------------
# データ取得設定（CSV版）
# ----------------------------------------------------------------------
data:
  exchange: csv  # CSV モードを指定
  symbol: BTC/USD  # CSVファイルのシンボル
  timeframe: 1h
  
  # CSV ファイル指定
  csv_path: data/btc_usd_2024_hourly.csv
  
  # 学習用データ期間（3ヶ月間で高速化）
  since: "2024-01-01T00:00:00Z"
  limit: 2190  # 3ヶ月分（91日 × 24時間）
  
  # API設定は無効化
  api_key: null
  api_secret: null
  ccxt_options: {}
  
  # マルチタイムフレーム設定
  multi_timeframe_data:
    base_timeframe: 1h
    target_timeframes:
      15m:
        method: interpolation
        min_points: 10
      1h:
        method: direct
        min_points: 10
      4h:
        method: aggregation
        min_points: 8

# ----------------------------------------------------------------------
# 戦略設定（低閾値・取引機会確保）
# ----------------------------------------------------------------------
strategy:
  type: single
  name: ml
  params:
    model_path: models/production/model.pkl  # 本番モデル使用
    threshold: 0.01  # 非常に低い閾値（取引機会最大化）
    
    # 動的閾値調整
    atr_multiplier: 0.2
    volatility_adjustment: false  # シンプル化
    threshold_bounds: [0.005, 0.05]

# ----------------------------------------------------------------------
# リスク管理（保守的設定）
# ----------------------------------------------------------------------
risk:
  risk_per_trade: 0.005   # 0.5%リスク（保守的）
  stop_atr_mult: 2.0      # 広めのストップロス
  atr_period: 20          # ATR期間
  
  # Kelly基準（保守的）
  kelly_criterion:
    enabled: true
    max_fraction: 0.02  # 2%上限
    min_trades_required: 3

# ----------------------------------------------------------------------
# バックテスト設定（高速化）
# ----------------------------------------------------------------------
backtest:
  starting_balance: 10000.0   # 1万円
  slippage_rate: 0.001        # 本番準拠
  trade_log_csv: "./results/trade_log_profitable_validation.csv"
  aggregate_out_prefix: "./results/aggregate_profitable_validation"

# ----------------------------------------------------------------------
# ウォークフォワード分割（高速化）
# ----------------------------------------------------------------------
walk_forward:
  train_window: 240      # 10日間学習（超高速化）
  test_window: 48        # 2日間テスト（超高速化）
  step: 12               # 12時間間隔でスライド

# ----------------------------------------------------------------------
# 機械学習（低閾値設定）
# ----------------------------------------------------------------------
ml:
  feat_period: 14
  lags: [1, 2, 3]
  rolling_window: 10
  horizon: 5
  target_type: classification
  model_type: lgbm
  confidence_threshold: 0.35  # 低閾値（取引機会確保）

# ----------------------------------------------------------------------
# 手数料設定（Bitbank準拠）
# ----------------------------------------------------------------------
bitbank:
  fee_optimization:
    enabled: true
    maker_fee: -0.0002
    taker_fee: 0.0012
    prefer_maker: true