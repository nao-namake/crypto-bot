# =============================================================================
# 高速本番検証バックテスト設定
# 本番設定ベース・CSV高速バックテスト・損益プラス確認用
# =============================================================================

# ----------------------------------------------------------------------
# データ取得設定（CSV版）
# ----------------------------------------------------------------------
data:
  exchange: csv  # CSV モードを指定
  symbol: BTC/USD  # CSVファイルのシンボル
  timeframe: 1h
  
  # CSV ファイル指定
  csv_path: data/btc_usd_2024_hourly.csv
  
  # 学習用データ期間（6ヶ月間でテスト高速化）
  since: "2024-01-01T00:00:00Z"
  limit: 4380  # 6ヶ月分（182日 × 24時間）
  
  # API設定は無効化
  api_key: null
  api_secret: null
  ccxt_options: {}
  
  # マルチタイムフレーム設定
  multi_timeframe_data:
    base_timeframe: 1h
    target_timeframes:
      15m:
        method: interpolation
        min_points: 10
      1h:
        method: direct
        min_points: 10
      4h:
        method: aggregation
        min_points: 8

# ----------------------------------------------------------------------
# 戦略設定（本番モデル使用）
# ----------------------------------------------------------------------
strategy:
  type: single
  name: ml
  params:
    model_path: models/production/model.pkl  # 本番モデル使用
    threshold: 0.02  # 本番よりやや低め（取引機会確保）
    
    # 動的閾値調整
    atr_multiplier: 0.3
    volatility_adjustment: true
    threshold_bounds: [0.01, 0.1]

# ----------------------------------------------------------------------
# リスク管理（本番準拠）
# ----------------------------------------------------------------------
risk:
  risk_per_trade: 0.01   # 1%リスク（本番準拠）
  stop_atr_mult: 1.2     # 本番準拠
  atr_period: 20         # 本番準拠
  
  # Kelly基準（本番準拠）
  kelly_criterion:
    enabled: true
    max_fraction: 0.03
    min_trades_required: 5

# ----------------------------------------------------------------------
# バックテスト設定（高速化）
# ----------------------------------------------------------------------
backtest:
  starting_balance: 10000.0   # 1万円
  slippage_rate: 0.001        # 本番準拠
  trade_log_csv: "./results/trade_log_fast_validation.csv"
  aggregate_out_prefix: "./results/aggregate_fast_validation"

# ----------------------------------------------------------------------
# ウォークフォワード分割（高速化）
# ----------------------------------------------------------------------
walk_forward:
  train_window: 360      # 15日間学習（高速化）
  test_window: 72        # 3日間テスト（高速化）
  step: 24               # 1日間隔でスライド

# ----------------------------------------------------------------------
# 機械学習（本番準拠）
# ----------------------------------------------------------------------
ml:
  feat_period: 14
  lags: [1, 2, 3]
  rolling_window: 10
  horizon: 5
  target_type: classification
  model_type: lgbm
  confidence_threshold: 0.65  # 本番準拠

# ----------------------------------------------------------------------
# 手数料設定（Bitbank準拠）
# ----------------------------------------------------------------------
bitbank:
  fee_optimization:
    enabled: true
    maker_fee: -0.0002
    taker_fee: 0.0012
    prefer_maker: true