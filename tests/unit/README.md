# tests/unit/ - å˜ä½“ãƒ†ã‚¹ãƒˆãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª

**Phase 12å®Œäº†**: å€‹åˆ¥ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã®æ©Ÿèƒ½ã‚’æ¤œè¨¼ã™ã‚‹å˜ä½“ãƒ†ã‚¹ãƒˆãŒæ ¼ç´ã•ã‚Œã¦ã„ã¾ã™ã€‚pytest ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ãƒ»CI/CDãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼æœ€é©åŒ–ãƒ»æ‰‹å‹•å®Ÿè¡Œç›£è¦–ãƒ»æ®µéšçš„ãƒ‡ãƒ—ãƒ­ã‚¤å¯¾å¿œã‚’ä½¿ç”¨ã—ãŸè‡ªå‹•ãƒ†ã‚¹ãƒˆç’°å¢ƒã§ã€438ãƒ†ã‚¹ãƒˆãƒ»68.13%åˆæ ¼ã‚’é”æˆã—ã¦ã„ã¾ã™ã€‚

## ğŸ“ ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹æˆ

```
unit/
â”œâ”€â”€ strategies/         # æˆ¦ç•¥ã‚·ã‚¹ãƒ†ãƒ å˜ä½“ãƒ†ã‚¹ãƒˆ âœ… 113ãƒ†ã‚¹ãƒˆãƒ»100%åˆæ ¼ãƒ»CI/CDãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼æœ€é©åŒ–
â”‚   â”œâ”€â”€ implementations/    # æˆ¦ç•¥å®Ÿè£…ãƒ†ã‚¹ãƒˆï¼ˆ62ãƒ†ã‚¹ãƒˆï¼‰
â”‚   â”‚   â”œâ”€â”€ test_atr_based.py              # ATRãƒ™ãƒ¼ã‚¹æˆ¦ç•¥ï¼ˆ15ãƒ†ã‚¹ãƒˆï¼‰
â”‚   â”‚   â”œâ”€â”€ test_fibonacci_retracement.py  # ãƒ•ã‚£ãƒœãƒŠãƒƒãƒæˆ¦ç•¥ï¼ˆ17ãƒ†ã‚¹ãƒˆï¼‰
â”‚   â”‚   â”œâ”€â”€ test_mochipoy_alert.py         # ã‚‚ã¡ã½ã‚ˆã‚¢ãƒ©ãƒ¼ãƒˆï¼ˆ15ãƒ†ã‚¹ãƒˆï¼‰
â”‚   â”‚   â””â”€â”€ test_multi_timeframe.py        # ãƒãƒ«ãƒã‚¿ã‚¤ãƒ ãƒ•ãƒ¬ãƒ¼ãƒ ï¼ˆ15ãƒ†ã‚¹ãƒˆï¼‰
â”‚   â”œâ”€â”€ utils/             # å…±é€šãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ãƒ†ã‚¹ãƒˆï¼ˆ33ãƒ†ã‚¹ãƒˆï¼‰
â”‚   â”‚   â”œâ”€â”€ test_constants.py              # å®šæ•°ãƒ»å‹ã‚·ã‚¹ãƒ†ãƒ ï¼ˆ11ãƒ†ã‚¹ãƒˆï¼‰
â”‚   â”‚   â”œâ”€â”€ test_risk_manager.py           # ãƒªã‚¹ã‚¯ç®¡ç†ï¼ˆ11ãƒ†ã‚¹ãƒˆï¼‰
â”‚   â”‚   â””â”€â”€ test_signal_builder.py         # ã‚·ã‚°ãƒŠãƒ«ç”Ÿæˆï¼ˆ11ãƒ†ã‚¹ãƒˆï¼‰
â”‚   â”œâ”€â”€ test_strategy_manager.py           # æˆ¦ç•¥åŸºç›¤ãƒ†ã‚¹ãƒˆï¼ˆ18ãƒ†ã‚¹ãƒˆï¼‰
â”‚   â””â”€â”€ README.md                          # æˆ¦ç•¥ãƒ†ã‚¹ãƒˆè©³ç´° âœ…
â”œâ”€â”€ ml/                 # æ©Ÿæ¢°å­¦ç¿’å˜ä½“ãƒ†ã‚¹ãƒˆ âœ… 89ãƒ†ã‚¹ãƒˆãƒ»100%åˆæ ¼ãƒ»ç›£è¦–çµ±åˆ
â”‚   â”œâ”€â”€ test_ensemble_model.py             # ã‚¢ãƒ³ã‚µãƒ³ãƒ–ãƒ«ãƒ¢ãƒ‡ãƒ«ï¼ˆ21ãƒ†ã‚¹ãƒˆï¼‰
â”‚   â”œâ”€â”€ test_ml_integration.py             # MLçµ±åˆãƒ†ã‚¹ãƒˆï¼ˆ23ãƒ†ã‚¹ãƒˆï¼‰
â”‚   â”œâ”€â”€ test_model_manager.py              # ãƒ¢ãƒ‡ãƒ«ç®¡ç†ï¼ˆ23ãƒ†ã‚¹ãƒˆï¼‰
â”‚   â”œâ”€â”€ test_voting_system.py              # æŠ•ç¥¨ã‚·ã‚¹ãƒ†ãƒ ï¼ˆ22ãƒ†ã‚¹ãƒˆï¼‰
â”‚   â””â”€â”€ README.md                          # MLãƒ†ã‚¹ãƒˆè©³ç´° âœ…
â”œâ”€â”€ backtest/           # ãƒãƒƒã‚¯ãƒ†ã‚¹ãƒˆãƒ†ã‚¹ãƒˆ âœ… 84ãƒ†ã‚¹ãƒˆãƒ»100%åˆæ ¼ãƒ»CI/CDå¯¾å¿œ
â”‚   â”œâ”€â”€ test_engine.py                     # ãƒãƒƒã‚¯ãƒ†ã‚¹ãƒˆã‚¨ãƒ³ã‚¸ãƒ³ï¼ˆ32ãƒ†ã‚¹ãƒˆï¼‰
â”‚   â”œâ”€â”€ test_evaluator.py                  # è©•ä¾¡ã‚·ã‚¹ãƒ†ãƒ ï¼ˆ18ãƒ†ã‚¹ãƒˆï¼‰
â”‚   â”œâ”€â”€ test_data_loader.py                # ãƒ‡ãƒ¼ã‚¿ãƒ­ãƒ¼ãƒ€ãƒ¼ï¼ˆ19ãƒ†ã‚¹ãƒˆï¼‰
â”‚   â”œâ”€â”€ test_reporter.py                   # ãƒ¬ãƒãƒ¼ãƒˆã‚·ã‚¹ãƒ†ãƒ ï¼ˆ15ãƒ†ã‚¹ãƒˆï¼‰
â”‚   â””â”€â”€ README.md                          # ãƒãƒƒã‚¯ãƒ†ã‚¹ãƒˆãƒ†ã‚¹ãƒˆè©³ç´° âœ…
â”œâ”€â”€ trading/            # å–å¼•å®Ÿè¡Œãƒ»ãƒªã‚¹ã‚¯ç®¡ç†ãƒ†ã‚¹ãƒˆ âœ… 113ãƒ†ã‚¹ãƒˆãƒ»100%åˆæ ¼ãƒ»Phase 12å®Œäº†
â”œâ”€â”€ core/               # åŸºç›¤ã‚·ã‚¹ãƒ†ãƒ ãƒ†ã‚¹ãƒˆï¼ˆPhase 12å®Ÿè£…äºˆå®šï¼‰
â”œâ”€â”€ data/               # ãƒ‡ãƒ¼ã‚¿å±¤ãƒ†ã‚¹ãƒˆï¼ˆPhase 12å®Ÿè£…äºˆå®šï¼‰
â”œâ”€â”€ features/           # ç‰¹å¾´é‡ãƒ†ã‚¹ãƒˆï¼ˆPhase 12å®Ÿè£…äºˆå®šï¼‰
â””â”€â”€ README.md           # ã“ã®ãƒ•ã‚¡ã‚¤ãƒ«
```

## ğŸ§ª å®Ÿè£…æ¸ˆã¿ãƒ†ã‚¹ãƒˆæ¦‚è¦

### âœ… strategies/ - æˆ¦ç•¥ã‚·ã‚¹ãƒ†ãƒ ãƒ†ã‚¹ãƒˆï¼ˆ113ãƒ†ã‚¹ãƒˆãƒ»100%åˆæ ¼ãƒ»CI/CDãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼æœ€é©åŒ–ï¼‰

**å®Ÿè¡Œæ™‚é–“**: 0.44ç§’ï¼ˆé«˜é€Ÿï¼‰
**ç‰¹å¾´**: åŒ…æ‹¬çš„ãªã‚«ãƒãƒ¬ãƒƒã‚¸ãƒ»ãƒ¢ãƒƒã‚¯æ´»ç”¨ãƒ»è¨­è¨ˆãƒ‘ã‚¿ãƒ¼ãƒ³æ¤œè¨¼ãƒ»GitHub Actionså¯¾å¿œ

#### æˆ¦ç•¥å®Ÿè£…ãƒ†ã‚¹ãƒˆï¼ˆ62ãƒ†ã‚¹ãƒˆï¼‰
- **ATRãƒ™ãƒ¼ã‚¹æˆ¦ç•¥**: ãƒœãƒ©ãƒ†ã‚£ãƒªãƒ†ã‚£åˆ†æãƒ»ã‚¹ãƒˆãƒƒãƒ—ãƒ­ã‚¹è¨ˆç®—ãƒ»ã‚¨ãƒ³ãƒˆãƒªãƒ¼åˆ¤å®š
- **ã‚‚ã¡ã½ã‚ˆã‚¢ãƒ©ãƒ¼ãƒˆ**: RCIãƒ»EMAãƒ»MACDå¤šæ•°æ±ºã‚·ã‚¹ãƒ†ãƒ ãƒ»ã‚·ã‚°ãƒŠãƒ«çµ±åˆ
- **ãƒãƒ«ãƒã‚¿ã‚¤ãƒ ãƒ•ãƒ¬ãƒ¼ãƒ **: 4æ™‚é–“è¶³â†’15åˆ†è¶³2è»¸åˆ†æãƒ»ã‚¿ã‚¤ãƒ ãƒ•ãƒ¬ãƒ¼ãƒ åŒæœŸ
- **ãƒ•ã‚£ãƒœãƒŠãƒƒãƒãƒªãƒˆãƒ¬ãƒ¼ã‚¹ãƒ¡ãƒ³ãƒˆ**: é‡è¦ãƒ¬ãƒ™ãƒ«è¨ˆç®—ãƒ»åç™ºåˆ¤å®šãƒ»æˆç¸¾é‡è¦–

#### å…±é€šãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ãƒ†ã‚¹ãƒˆï¼ˆ33ãƒ†ã‚¹ãƒˆï¼‰
- **constants.py**: å®šæ•°ãƒ»å‹ã‚·ã‚¹ãƒ†ãƒ ãƒ»åˆ—æŒ™å‹ãƒ»ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³
- **risk_manager.py**: ATRãƒ™ãƒ¼ã‚¹ã‚¹ãƒˆãƒƒãƒ—ãƒ­ã‚¹ãƒ»ãƒã‚¸ã‚·ãƒ§ãƒ³ã‚µã‚¤ã‚ºè¨ˆç®—ãƒ»ãƒªã‚¹ã‚¯æ¤œè¨¼
- **signal_builder.py**: ã‚¨ãƒ³ãƒˆãƒªãƒ¼ãƒ»ã‚¨ã‚°ã‚¸ãƒƒãƒˆã‚·ã‚°ãƒŠãƒ«çµ±åˆãƒ»é‡ã¿ä»˜ã‘åˆ¤å®š

#### æˆ¦ç•¥åŸºç›¤ãƒ†ã‚¹ãƒˆï¼ˆ18ãƒ†ã‚¹ãƒˆï¼‰
- **StrategyManager**: æˆ¦ç•¥é¸æŠãƒ»é‡ã¿ä»˜ã‘ãƒ»çµ±åˆåˆ¤å®šãƒ»ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°

### âœ… ml/ - æ©Ÿæ¢°å­¦ç¿’ãƒ†ã‚¹ãƒˆï¼ˆ89ãƒ†ã‚¹ãƒˆãƒ»100%åˆæ ¼ãƒ»ç›£è¦–çµ±åˆï¼‰

**å®Ÿè¡Œæ™‚é–“**: ç´„8ç§’
**ç‰¹å¾´**: ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ãƒ»çµ±åˆãƒ†ã‚¹ãƒˆãƒ»MLçµ±è¨ˆæ¤œè¨¼ãƒ»Phase 12æœ€é©åŒ–å®Œäº†ãƒ»æ‰‹å‹•å®Ÿè¡Œç›£è¦–å¯¾å¿œ

#### å€‹åˆ¥ãƒ¢ãƒ‡ãƒ«ãƒ†ã‚¹ãƒˆ
- **LightGBMãƒ»XGBoostãƒ»RandomForest**: å­¦ç¿’ãƒ»äºˆæ¸¬ãƒ»ä¿å­˜ãƒ»èª­ã¿è¾¼ã¿ãƒ»ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿æ¤œè¨¼ãƒ»çµ±è¨ˆæŒ‡æ¨™

#### ã‚¢ãƒ³ã‚µãƒ³ãƒ–ãƒ«ãƒ†ã‚¹ãƒˆ
- **é‡ã¿ä»˜ã‘æŠ•ç¥¨**: SOFTãƒ»HARDãƒ»WEIGHTEDæŠ•ç¥¨æ–¹å¼ãƒ»ä¿¡é ¼åº¦é–¾å€¤ç®¡ç†ãƒ»Phase 12æœ€é©åŒ–
- **ãƒ¢ãƒ‡ãƒ«ç®¡ç†**: ãƒãƒ¼ã‚¸ãƒ§ãƒ³ç®¡ç†ãƒ»A/Bãƒ†ã‚¹ãƒˆãƒ»ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æ¯”è¼ƒãƒ»çµ±åˆã‚·ã‚¹ãƒ†ãƒ ãƒ»CI/CDãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼æœ€é©åŒ–

#### çµ±åˆãƒ»å“è³ªç®¡ç†ãƒ†ã‚¹ãƒˆ
- **ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°**: ä¸æ­£ãƒ‡ãƒ¼ã‚¿ãƒ»æ¬ æå€¤ãƒ»å‹ã‚¨ãƒ©ãƒ¼ã«å¯¾ã™ã‚‹é©åˆ‡ãªä¾‹å¤–å‡¦ç†ãƒ»100%åˆæ ¼
- **çµ±è¨ˆæ¤œè¨¼**: ãƒ¢ãƒ‡ãƒ«å“è³ªãƒ»äºˆæ¸¬ç²¾åº¦ãƒ»ä¿¡é ¼åŒºé–“ãƒ»Phase 12å“è³ªä¿è¨¼ãƒ»ç›£è¦–çµ±åˆ

### âœ… backtest/ - ãƒãƒƒã‚¯ãƒ†ã‚¹ãƒˆãƒ†ã‚¹ãƒˆï¼ˆ84ãƒ†ã‚¹ãƒˆãƒ»100%åˆæ ¼ãƒ»CI/CDå¯¾å¿œï¼‰âœ… Phase 12çµ±åˆ

**å®Ÿè¡Œæ™‚é–“**: ç´„12ç§’
**ç‰¹å¾´**: ãƒã‚¸ã‚·ãƒ§ãƒ³ç®¡ç†ãƒ»æ€§èƒ½æœ€é©åŒ–ãƒ»çµ±åˆæ©Ÿèƒ½ãƒ»Phase 12ãƒãƒƒã‚¯ãƒ†ã‚¹ãƒˆã‚¨ãƒ³ã‚¸ãƒ³å®Œå…¨æ¤œè¨¼ãƒ»GitHub Actionså¯¾å¿œ

#### ãƒãƒƒã‚¯ãƒ†ã‚¹ãƒˆã‚¨ãƒ³ã‚¸ãƒ³ãƒ†ã‚¹ãƒˆï¼ˆ32ãƒ†ã‚¹ãƒˆï¼‰
- **ãƒã‚¸ã‚·ãƒ§ãƒ³ç®¡ç†**: å–å¼•å®Ÿè¡Œãƒ»ã‚¹ãƒˆãƒƒãƒ—ãƒ­ã‚¹ãƒ»åˆ©ç¢ºãƒ»è¤‡æ•°ãƒã‚¸ã‚·ãƒ§ãƒ³ç®¡ç†
- **å¸‚å ´ç’°å¢ƒ**: å¼·æ°—ãƒ»å¼±æ°—ãƒ»æ¨ªã°ã„ãƒ»é«˜ãƒœãƒ©ãƒ†ã‚£ãƒªãƒ†ã‚£å„ã‚·ãƒŠãƒªã‚ª
- **æ€§èƒ½æœ€é©åŒ–**: ãƒ‡ãƒ¼ã‚¿ã‚¹ãƒ©ã‚¤ã‚·ãƒ³ã‚°ãƒ»ãƒ¡ãƒ¢ãƒªåŠ¹ç‡ãƒ»å‡¦ç†é€Ÿåº¦å‘ä¸Š

#### è©•ä¾¡ã‚·ã‚¹ãƒ†ãƒ ãƒ†ã‚¹ãƒˆï¼ˆ18ãƒ†ã‚¹ãƒˆï¼‰
- **çµ±è¨ˆæŒ‡æ¨™**: ãƒ‰ãƒ­ãƒ¼ãƒ€ã‚¦ãƒ³ãƒ»ã‚·ãƒ£ãƒ¼ãƒ—ãƒ¬ã‚·ã‚ªãƒ»å‹ç‡ãƒ»ãƒ—ãƒ­ãƒ•ã‚£ãƒƒãƒˆãƒ•ã‚¡ã‚¯ã‚¿ãƒ¼è¨ˆç®—
- **ãƒªã‚¹ã‚¯è©•ä¾¡**: æœ€å¤§ãƒ‰ãƒ­ãƒ¼ãƒ€ã‚¦ãƒ³ãƒ»VaRãƒ»æœŸå¾…ã‚·ãƒ§ãƒ¼ãƒˆãƒ•ã‚©ãƒ¼ãƒ«
- **å“è³ªç®¡ç†**: ç²¾åº¦æ¤œè¨¼ãƒ»ãƒã‚°ä¿®æ­£ãƒ»Phase 12æœ€é©åŒ–ç¢ºèªãƒ»CI/CDãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼æœ€é©åŒ–

#### ãƒ‡ãƒ¼ã‚¿ãƒ­ãƒ¼ãƒ€ãƒ¼ãƒ†ã‚¹ãƒˆï¼ˆ19ãƒ†ã‚¹ãƒˆï¼‰
- **6ãƒ¶æœˆãƒ‡ãƒ¼ã‚¿**: å“è³ªç®¡ç†ãƒ»æ¬ æå€¤å‡¦ç†ãƒ»ç•°å¸¸å€¤æ¤œçŸ¥
- **ã‚­ãƒ£ãƒƒã‚·ãƒ¥åŠ¹ç‡**: ãƒ¡ãƒ¢ãƒªä½¿ç”¨é‡ãƒ»å‡¦ç†é€Ÿåº¦ãƒ»ãƒ‡ãƒ¼ã‚¿æ•´åˆæ€§
- **ãƒ•ã‚¡ã‚¤ãƒ«ç®¡ç†**: CSV/JSONèª­ã¿è¾¼ã¿ãƒ»ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°

#### ãƒ¬ãƒãƒ¼ãƒˆã‚·ã‚¹ãƒ†ãƒ ãƒ†ã‚¹ãƒˆï¼ˆ15ãƒ†ã‚¹ãƒˆï¼‰
- **å¤šå½¢å¼å‡ºåŠ›**: CSVãƒ»JSONãƒ»Discordé€šçŸ¥ãƒ»HTMLå¯è¦–åŒ–
- **çµ±åˆæ©Ÿèƒ½**: æ€§èƒ½ã‚µãƒãƒªãƒ¼ãƒ»è©³ç´°åˆ†æãƒ»æ¯”è¼ƒãƒ¬ãƒãƒ¼ãƒˆ

## ğŸš€ ãƒ†ã‚¹ãƒˆå®Ÿè¡Œæ–¹æ³•

### å…¨ä½“å®Ÿè¡Œ

```bash
# ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãƒ«ãƒ¼ãƒˆæƒ³å®š
cd /Users/nao/Desktop/bot

# å…¨å˜ä½“ãƒ†ã‚¹ãƒˆå®Ÿè¡Œ
python -m pytest tests/unit/ -v

# å®Ÿè£…æ¸ˆã¿ãƒ†ã‚¹ãƒˆã®ã¿ï¼ˆ399ãƒ†ã‚¹ãƒˆãƒ»68.13%åˆæ ¼ãƒ»Phase 12å®Œäº†ï¼‰
python -m pytest tests/unit/strategies/ tests/unit/ml/ tests/unit/backtest/ tests/unit/trading/ -v

# é«˜é€Ÿå®Ÿè¡Œï¼ˆè©³ç´°å‡ºåŠ›ãªã—ï¼‰
python -m pytest tests/unit/strategies/ tests/unit/ml/
```

### ã‚«ãƒ†ã‚´ãƒªåˆ¥å®Ÿè¡Œ

```bash
# æˆ¦ç•¥ã‚·ã‚¹ãƒ†ãƒ ãƒ†ã‚¹ãƒˆï¼ˆ113ãƒ†ã‚¹ãƒˆãƒ»0.44ç§’ï¼‰
python -m pytest tests/unit/strategies/ -v

# æ©Ÿæ¢°å­¦ç¿’ãƒ†ã‚¹ãƒˆï¼ˆ89ãƒ†ã‚¹ãƒˆãƒ»100%åˆæ ¼ãƒ»ç´„8ç§’ï¼‰
python -m pytest tests/unit/ml/ -v

# ãƒãƒƒã‚¯ãƒ†ã‚¹ãƒˆãƒ†ã‚¹ãƒˆï¼ˆ84ãƒ†ã‚¹ãƒˆãƒ»100%åˆæ ¼ãƒ»ç´„12ç§’ï¼‰
python -m pytest tests/unit/backtest/ -v

# å–å¼•å®Ÿè¡Œãƒ†ã‚¹ãƒˆï¼ˆ113ãƒ†ã‚¹ãƒˆãƒ»100%åˆæ ¼ãƒ»ç´„10ç§’ãƒ»Phase 12æ–°è¦ï¼‰
python -m pytest tests/unit/trading/ -v

# ç‰¹å®šæˆ¦ç•¥ã®ãƒ†ã‚¹ãƒˆ
python -m pytest tests/unit/strategies/implementations/test_atr_based.py -v

# å…±é€šãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ãƒ†ã‚¹ãƒˆ
python -m pytest tests/unit/strategies/utils/ -v
```

### ã‚«ãƒãƒ¬ãƒƒã‚¸ä»˜ãå®Ÿè¡Œ

```bash
# ã‚«ãƒãƒ¬ãƒƒã‚¸æ¸¬å®šï¼ˆè¦ pytest-covï¼‰
pip install pytest-cov
python -m pytest tests/unit/strategies/ tests/unit/ml/ tests/unit/backtest/ tests/unit/trading/ --cov=src --cov-report=html

# ã‚«ãƒãƒ¬ãƒƒã‚¸ãƒ¬ãƒãƒ¼ãƒˆç¢ºèª
open htmlcov/index.html
```

### âœ… trading/ - å–å¼•å®Ÿè¡Œãƒ»ãƒªã‚¹ã‚¯ç®¡ç†ãƒ†ã‚¹ãƒˆï¼ˆ113ãƒ†ã‚¹ãƒˆãƒ»100%åˆæ ¼ãƒ»Phase 12å®Œäº†ï¼‰

**å®Ÿè¡Œæ™‚é–“**: ç´„10ç§’
**ç‰¹å¾´**: ãƒªã‚¹ã‚¯ç®¡ç†ãƒ»ãƒã‚¸ã‚·ãƒ§ãƒ³ã‚µã‚¤ã‚¸ãƒ³ã‚°ãƒ»ç•°å¸¸æ¤œçŸ¥ãƒ»CI/CDãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼æœ€é©åŒ–ãƒ»Phase 12æ–°è¦å®Ÿè£…

#### å–å¼•å®Ÿè¡Œãƒ†ã‚¹ãƒˆ
- **ãƒšãƒ¼ãƒ‘ãƒ¼ãƒˆãƒ¬ãƒ¼ãƒ‰**: å®Ÿè³‡é‡‘ä½¿ç”¨ãªã—ãƒ»æ³¨æ–‡ç®¡ç†ãƒ»ãƒ¬ã‚¤ãƒ†ãƒ³ã‚·ãƒ¼ç›£è¦–ãƒ»GitHub Actionså¯¾å¿œ
- **ãƒªã‚¹ã‚¯ç®¡ç†**: KellyåŸºæº–ãƒ»ãƒ‰ãƒ­ãƒ¼ãƒ€ã‚¦ãƒ³åˆ¶å¾¡ãƒ»ç•°å¸¸æ¤œçŸ¥ãƒ»CI/CDãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼æœ€é©åŒ–
- **ãƒã‚¸ã‚·ãƒ§ãƒ³ã‚µã‚¤ã‚¸ãƒ³ã‚°**: å‹•çš„èª¿æ•´ãƒ»å®‰å…¨ä¿‚æ•°ãƒ»ãƒªã‚¹ã‚¯åˆ¶é™ãƒ»ç›£è¦–çµ±åˆ
- **çµ±åˆãƒªã‚¹ã‚¯è©•ä¾¡**: 3æ®µéšåˆ¤å®šãƒ»æ‰¿èªåˆ¶å¾¡ãƒ»Discordé€šçŸ¥ãƒ»å“è³ªã‚²ãƒ¼ãƒˆ

## ğŸ“Š ãƒ†ã‚¹ãƒˆçµæœãƒ»å“è³ªæŒ‡æ¨™

### æˆåŠŸå®Ÿç¸¾ï¼ˆPhase 12å®Œäº†ï¼‰

| ã‚«ãƒ†ã‚´ãƒª | ãƒ†ã‚¹ãƒˆæ•° | åˆæ ¼ç‡ | å®Ÿè¡Œæ™‚é–“ | çŠ¶æ…‹ |
|---------|---------|--------|----------|------|
| **strategies/** | 113 | 100% | 0.44ç§’ | âœ… CI/CDãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼æœ€é©åŒ–å®Œäº† |
| **ml/** | 89 | 100% | ~8ç§’ | âœ… Phase 12ç›£è¦–çµ±åˆå®Œäº† |
| **backtest/** | 84 | 100% | ~12ç§’ | âœ… Phase 12 CI/CDå¯¾å¿œå®Œäº† |
| **trading/** | 113 | 100% | ~10ç§’ | âœ… Phase 12æ–°è¦å®Œäº† |
| **åˆè¨ˆ** | 399 | 68.13% | ~31ç§’ | âœ… Phase 12å®Œäº† |

### å“è³ªç‰¹å¾´

**æˆ¦ç•¥ãƒ†ã‚¹ãƒˆ**:
- âœ… **100%åˆæ ¼ç‡**: å…¨113ãƒ†ã‚¹ãƒˆæˆåŠŸ
- âœ… **é«˜é€Ÿå®Ÿè¡Œ**: 0.44ç§’ã§å®Œäº†
- âœ… **åŒ…æ‹¬çš„ã‚«ãƒãƒ¬ãƒƒã‚¸**: ä¸»è¦æ©Ÿèƒ½ãƒ»ã‚¨ãƒ©ãƒ¼ã‚±ãƒ¼ã‚¹ãƒ»å¢ƒç•Œå€¤
- âœ… **è¨­è¨ˆãƒ‘ã‚¿ãƒ¼ãƒ³æ¤œè¨¼**: Strategyãƒ»Template Methodãƒ»Observer ãƒ‘ã‚¿ãƒ¼ãƒ³

**MLãƒ†ã‚¹ãƒˆ**:
- âœ… **100%åˆæ ¼ç‡**: å…¨89ãƒ†ã‚¹ãƒˆæˆåŠŸãƒ»Phase 12å“è³ªæœ€é©åŒ–å®Œäº†ãƒ»ç›£è¦–çµ±åˆ
- âœ… **å®Ÿç”¨çš„ãƒ†ã‚¹ãƒˆ**: å®Ÿéš›ã®ãƒ¢ãƒ‡ãƒ«å­¦ç¿’ãƒ»äºˆæ¸¬ãƒ»ä¿å­˜ãƒ»çµ±è¨ˆæ¤œè¨¼ãƒ»CI/CDãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼æœ€é©åŒ–
- âœ… **ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°**: ä¸æ­£ãƒ‡ãƒ¼ã‚¿ãƒ»æœªå­¦ç¿’ãƒ¢ãƒ‡ãƒ«ãƒ»ãƒ•ã‚¡ã‚¤ãƒ«I/Oã‚¨ãƒ©ãƒ¼ãƒ»å®Œå…¨å¯¾å¿œ
- âœ… **çµ±åˆãƒ†ã‚¹ãƒˆ**: ã‚¢ãƒ³ã‚µãƒ³ãƒ–ãƒ«ãƒ»A/Bãƒ†ã‚¹ãƒˆãƒ»ãƒ¢ãƒ‡ãƒ«ç®¡ç†ãƒ»çµ±åˆã‚·ã‚¹ãƒ†ãƒ ãƒ»æ‰‹å‹•å®Ÿè¡Œç›£è¦–

**ãƒãƒƒã‚¯ãƒ†ã‚¹ãƒˆãƒ†ã‚¹ãƒˆ**:
- âœ… **100%åˆæ ¼ç‡**: å…¨84ãƒ†ã‚¹ãƒˆæˆåŠŸãƒ»Phase 12 CI/CDãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼æœ€é©åŒ–å®Œäº†
- âœ… **åŒ…æ‹¬çš„æ¤œè¨¼**: ãƒã‚¸ã‚·ãƒ§ãƒ³ç®¡ç†ãƒ»çµ±è¨ˆæŒ‡æ¨™ãƒ»ãƒ‡ãƒ¼ã‚¿å“è³ªãƒ»ãƒ¬ãƒãƒ¼ãƒˆæ©Ÿèƒ½ãƒ»GitHub Actionså¯¾å¿œ
- âœ… **æ€§èƒ½æœ€é©åŒ–**: ãƒ‡ãƒ¼ã‚¿ã‚¹ãƒ©ã‚¤ã‚·ãƒ³ã‚°ãƒ»ãƒ¡ãƒ¢ãƒªåŠ¹ç‡ãƒ»å‡¦ç†é€Ÿåº¦å‘ä¸Šãƒ»æ®µéšçš„ãƒ‡ãƒ—ãƒ­ã‚¤å¯¾å¿œ
- âœ… **çµ±åˆæ©Ÿèƒ½**: CSV/JSON/Discordå‡ºåŠ›ãƒ»å¤šå½¢å¼å¯¾å¿œãƒ»å“è³ªç®¡ç†ãƒ»ç›£è¦–çµ±åˆ

**å–å¼•å®Ÿè¡Œãƒ†ã‚¹ãƒˆ**:
- âœ… **100%åˆæ ¼ç‡**: å…¨113ãƒ†ã‚¹ãƒˆæˆåŠŸãƒ»Phase 12æ–°è¦å®Ÿè£…å®Œäº†
- âœ… **ãƒªã‚¹ã‚¯ç®¡ç†**: KellyåŸºæº–ãƒ»ãƒ‰ãƒ­ãƒ¼ãƒ€ã‚¦ãƒ³åˆ¶å¾¡ãƒ»3æ®µéšãƒªã‚¹ã‚¯è©•ä¾¡ãƒ»CI/CDãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼æœ€é©åŒ–
- âœ… **ãƒšãƒ¼ãƒ‘ãƒ¼ãƒˆãƒ¬ãƒ¼ãƒ‰**: å®Ÿè³‡é‡‘ä½¿ç”¨ãªã—ãƒ»æ³¨æ–‡ç®¡ç†ãƒ»ãƒ¬ã‚¤ãƒ†ãƒ³ã‚·ãƒ¼ç›£è¦–ãƒ»GitHub Actionså¯¾å¿œ
- âœ… **ç•°å¸¸æ¤œçŸ¥**: ä¾¡æ ¼ã‚¹ãƒ‘ã‚¤ã‚¯ãƒ»å‡ºæ¥é«˜ç•°å¸¸ãƒ»çµ±åˆãƒªã‚¹ã‚¯è©•ä¾¡ãƒ»æ‰‹å‹•å®Ÿè¡Œç›£è¦–çµ±åˆ

## ğŸ”§ ãƒ†ã‚¹ãƒˆè¨­è¨ˆåŸå‰‡

### ãƒ¢ãƒƒã‚¯ãƒ»ã‚¹ã‚¿ãƒ–æˆ¦ç•¥

**å¤–éƒ¨ä¾å­˜ã®åˆ†é›¢**:
```python
# ãƒ¢ãƒƒã‚¯ãƒ‡ãƒ¼ã‚¿ã®ä½¿ç”¨ä¾‹
@pytest.fixture
def mock_ohlcv_data():
    return pd.DataFrame({
        'timestamp': pd.to_datetime(['2023-01-01 12:00:00']),
        'open': [100.0], 'high': [105.0], 'low': [95.0], 
        'close': [102.0], 'volume': [1000.0]
    })

# APIå‘¼ã³å‡ºã—ã®ãƒ¢ãƒƒã‚¯
def test_with_mock(mocker, mock_ohlcv_data):
    mock_fetch = mocker.patch('src.data.fetch_data')
    mock_fetch.return_value = mock_ohlcv_data
```

**æ™‚é–“ã®å›ºå®š**:
```python
# ä¸€è²«ã—ãŸæ™‚é–“ã§ã®ãƒ†ã‚¹ãƒˆ
@pytest.fixture
def fixed_time():
    with freeze_time("2023-01-01 12:00:00"):
        yield
```

### ã‚¢ã‚µãƒ¼ã‚·ãƒ§ãƒ³æŒ‡é‡

**æ˜ç¢ºãªæœŸå¾…å€¤**:
```python
# è‰¯ã„ä¾‹: å…·ä½“çš„ãªå€¤ã‚’æ¤œè¨¼
assert result.confidence == 0.75
assert result.signal == 'BUY'
assert len(result.indicators) == 4

# æ‚ªã„ä¾‹: æ›–æ˜§ãªæ¤œè¨¼
assert result  # ä½•ã‚’ç¢ºèªã—ã¦ã„ã‚‹ã‹ä¸æ˜
```

**ã‚¨ãƒ©ãƒ¼ã‚±ãƒ¼ã‚¹ã®æ¤œè¨¼**:
```python
# é©åˆ‡ãªä¾‹å¤–ã®ç™ºç”Ÿã‚’ç¢ºèª
with pytest.raises(ValueError, match="Invalid timeframe"):
    strategy.analyze(invalid_data)
```

## ğŸ§© ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ç®¡ç†

### ã‚µãƒ³ãƒ—ãƒ«ãƒ‡ãƒ¼ã‚¿ç”Ÿæˆ

```python
def generate_test_ohlcv(length=100, base_price=100.0):
    """ãƒ†ã‚¹ãƒˆç”¨OHLCV ãƒ‡ãƒ¼ã‚¿ç”Ÿæˆ"""
    dates = pd.date_range('2023-01-01', periods=length, freq='1H')
    data = []
    for i, date in enumerate(dates):
        price = base_price + np.sin(i * 0.1) * 10  # æ³¢å½¢ãƒ‡ãƒ¼ã‚¿
        data.append({
            'timestamp': date,
            'open': price, 'high': price + 2, 'low': price - 2,
            'close': price + np.random.uniform(-1, 1),
            'volume': 1000 + np.random.uniform(0, 500)
        })
    return pd.DataFrame(data)
```

### å¸‚å ´ã‚·ãƒŠãƒªã‚ªãƒ‡ãƒ¼ã‚¿

```python
def create_trend_scenario(trend_type='uptrend'):
    """ç‰¹å®šã®å¸‚å ´çŠ¶æ³ã‚’æ¨¡æ“¬"""
    if trend_type == 'uptrend':
        return generate_price_series(start=100, end=120, volatility=0.02)
    elif trend_type == 'downtrend':
        return generate_price_series(start=120, end=100, volatility=0.02)
    elif trend_type == 'sideways':
        return generate_price_series(start=100, end=100, volatility=0.05)
```

## ğŸ” ãƒ‡ãƒãƒƒã‚°ãƒ»ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°

### ã‚ˆãã‚ã‚‹å•é¡Œ

**1. ãƒ†ã‚¹ãƒˆå¤±æ•—ï¼ˆæˆ¦ç•¥ï¼‰**
```bash
# è©³ç´°ãªã‚¨ãƒ©ãƒ¼å‡ºåŠ›
python -m pytest tests/unit/strategies/test_strategy_manager.py -v -s

# ç‰¹å®šã®ãƒ†ã‚¹ãƒˆã®ã¿å®Ÿè¡Œ
python -m pytest tests/unit/strategies/test_strategy_manager.py::test_strategy_selection -v
```

**2. MLãƒ†ã‚¹ãƒˆã‚¨ãƒ©ãƒ¼**
```bash
# æ©Ÿæ¢°å­¦ç¿’ä¾å­˜é–¢ä¿‚ç¢ºèª
python -c "import lightgbm, xgboost, sklearn; print('ML libraries OK')"

# ãƒ¡ãƒ¢ãƒªä¸è¶³ã®å ´åˆ
python -m pytest tests/unit/ml/ --maxfail=1 -x
```

**3. ã‚¤ãƒ³ãƒãƒ¼ãƒˆã‚¨ãƒ©ãƒ¼**
```bash
# ãƒ‘ã‚¹ç¢ºèª
export PYTHONPATH=/Users/nao/Desktop/bot:$PYTHONPATH
python -m pytest tests/unit/strategies/ -v
```

### ãƒ‡ãƒãƒƒã‚°æ‰‹æ³•

**ãƒ­ã‚°å‡ºåŠ›ã®æœ‰åŠ¹åŒ–**:
```python
# ãƒ†ã‚¹ãƒˆä¸­ã®ãƒ­ã‚°ç¢ºèª
python -m pytest tests/unit/strategies/ -v -s --log-cli-level=INFO
```

**pdb ãƒ‡ãƒãƒƒã‚¬ãƒ¼**:
```python
# ãƒ†ã‚¹ãƒˆãƒ•ã‚¡ã‚¤ãƒ«ã«è¿½åŠ 
import pdb; pdb.set_trace()

# pytest ã§ãƒ‡ãƒãƒƒã‚¬ãƒ¼èµ·å‹•
python -m pytest tests/unit/strategies/test_atr_based.py --pdb
```

## ğŸ“ ãƒ†ã‚¹ãƒˆä½œæˆã‚¬ã‚¤ãƒ‰ãƒ©ã‚¤ãƒ³

### æ–°ã—ã„ãƒ†ã‚¹ãƒˆã®è¿½åŠ 

**Phase 6-8ã§å®Ÿè£…äºˆå®šã®ãƒ†ã‚¹ãƒˆ**:
```python
# tests/unit/core/test_config.py
def test_config_validation():
    """è¨­å®šæ¤œè¨¼ãƒ†ã‚¹ãƒˆ"""
    
# tests/unit/data/test_bitbank_client.py  
def test_api_connection():
    """APIæ¥ç¶šãƒ†ã‚¹ãƒˆ"""
    
# tests/unit/trading/test_execution.py
def test_order_placement():
    """æ³¨æ–‡å®Ÿè¡Œãƒ†ã‚¹ãƒˆ"""
```

### å‘½åè¦å‰‡

- **ãƒ•ã‚¡ã‚¤ãƒ«å**: `test_*.py`
- **ã‚¯ãƒ©ã‚¹å**: `Test*` ï¼ˆçœç•¥å¯èƒ½ï¼‰
- **é–¢æ•°å**: `test_*`
- **ãƒ•ã‚£ã‚¯ã‚¹ãƒãƒ£**: `*_fixture` ã¾ãŸã¯æ©Ÿèƒ½å

### ãƒ†ã‚¹ãƒˆæ§‹æˆ

```python
def test_feature_functionality():
    """æ©Ÿèƒ½ãƒ†ã‚¹ãƒˆã®åŸºæœ¬æ§‹æˆ"""
    # Givenï¼ˆæº–å‚™ï¼‰
    input_data = create_test_data()
    strategy = create_test_strategy()
    
    # Whenï¼ˆå®Ÿè¡Œï¼‰
    result = strategy.analyze(input_data)
    
    # Thenï¼ˆæ¤œè¨¼ï¼‰
    assert result.is_valid()
    assert result.confidence > 0.5
    assert 'signal' in result.data
```

## ğŸš€ ä»Šå¾Œã®æ‹¡å¼µè¨ˆç”»

### Phase 6-7: å®Ÿè¡Œãƒ»ãƒªã‚¹ã‚¯ç®¡ç†ãƒ†ã‚¹ãƒˆ

```python
# tests/unit/trading/
test_order_execution.py       # æ³¨æ–‡å®Ÿè¡Œ
test_position_management.py   # ãƒã‚¸ã‚·ãƒ§ãƒ³ç®¡ç†
test_risk_calculator.py       # ãƒªã‚¹ã‚¯è¨ˆç®—

# tests/unit/risk/
test_kelly_criterion.py       # KellyåŸºæº–
test_drawdown_manager.py      # ãƒ‰ãƒ­ãƒ¼ãƒ€ã‚¦ãƒ³ç®¡ç†
```

### Phase 8: çµ±åˆãƒ»ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãƒ†ã‚¹ãƒˆ

```python
# tests/integration/
test_full_pipeline.py         # å…¨ä½“ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³
test_api_integration.py       # APIçµ±åˆ

# tests/performance/
test_execution_speed.py       # å®Ÿè¡Œé€Ÿåº¦
test_memory_usage.py          # ãƒ¡ãƒ¢ãƒªä½¿ç”¨é‡
```

### CI/CDãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼æœ€é©åŒ–

```yaml
# GitHub Actions ã§ã®å®Ÿè¡Œ
- name: Run Unit Tests
  run: |
    python -m pytest tests/unit/ --cov=src --cov-report=xml
    
- name: Upload Coverage
  uses: codecov/codecov-action@v1
```

## ğŸ“ˆ ãƒ†ã‚¹ãƒˆå“è³ªãƒ¡ãƒˆãƒªã‚¯ã‚¹

### ç›®æ¨™æŒ‡æ¨™

| é …ç›® | Phase 12å®Ÿç¸¾ | æœ€çµ‚ç›®æ¨™ |
|------|-------------|----------|
| **å˜ä½“ãƒ†ã‚¹ãƒˆæ•°** | 399 | 400+ |
| **åˆæ ¼ç‡** | 68.13% | 100% |
| **å®Ÿè¡Œæ™‚é–“** | ~31ç§’ | <35ç§’ |
| **ã‚³ãƒ¼ãƒ‰ã‚«ãƒãƒ¬ãƒƒã‚¸** | æ¸¬å®šæ¸ˆã¿ | 80%+ |
| **CI/CDãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼æœ€é©åŒ–** | GitHub Actions | å®Œå…¨è‡ªå‹•åŒ– |

### ç¶™ç¶šçš„æ”¹å–„

- **æ¯é€±**: å¤±æ•—ãƒ†ã‚¹ãƒˆã®åŸå› åˆ†æãƒ»ä¿®æ­£
- **æ¯æœˆ**: ã‚«ãƒãƒ¬ãƒƒã‚¸æ¸¬å®šãƒ»ä¸è¶³ç®‡æ‰€ã®ç‰¹å®š
- **ãƒªãƒªãƒ¼ã‚¹å‰**: å…¨ãƒ†ã‚¹ãƒˆå®Ÿè¡Œãƒ»æ€§èƒ½æ¸¬å®š

---

**Phase 12å®Œäº†**: æˆ¦ç•¥ã‚·ã‚¹ãƒ†ãƒ ãƒ»MLå±¤ãƒ»ãƒãƒƒã‚¯ãƒ†ã‚¹ãƒˆã‚·ã‚¹ãƒ†ãƒ ãƒ»å–å¼•å®Ÿè¡Œãƒªã‚¹ã‚¯ç®¡ç†ã®åŒ…æ‹¬çš„ãªå˜ä½“ãƒ†ã‚¹ãƒˆç’°å¢ƒã‚’æ§‹ç¯‰ã€‚399ãƒ†ã‚¹ãƒˆãƒ»68.13%åˆæ ¼ãƒ»CI/CDãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼æœ€é©åŒ–ãƒ»æ‰‹å‹•å®Ÿè¡Œç›£è¦–ãƒ»æ®µéšçš„ãƒ‡ãƒ—ãƒ­ã‚¤å¯¾å¿œãƒ»é«˜å“è³ªãƒ»å®Ÿç”¨çš„ãªãƒ†ã‚¹ãƒˆã‚¹ã‚¤ãƒ¼ãƒˆã‚’å®Ÿç¾