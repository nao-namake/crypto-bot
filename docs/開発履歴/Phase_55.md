# Phase 55 開発記録

**期間**: 2025/12/20-
**状況**: Phase 55.1完了

---

## 📋 Phase 55 概要

### 目的
6戦略の見直しとバランスの最適化

### 背景
- Phase 54でATRレンジ消尽戦略をリファクタリング（PF 0.86→1.46）
- 現在6戦略中、収益性にばらつきあり
- 各戦略の独自性と相互補完性を最適化

### Phase一覧

| Phase | 内容 | 状態 | 主要成果 |
|-------|------|------|----------|
| 55.1 | ATRレンジ消尽戦略の閾値調整 | ✅ | 取引数+30%、PF 1.16維持 |
| 55.2 | 次戦略見直し | 予定 | - |
| 55.3 | - | 予定 | - |
| 55.4 | 重みづけ最終調整 | 予定 | - |

---

## ✅ Phase 55.1: ATRレンジ消尽戦略の閾値調整【完了】

### 実施日: 2025/12/20

### 目的
Phase 54.12で作成したATRレンジ消尽戦略のHOLD率を下げ、取引数を増加させる。

### 背景
- Phase 54.12でATRレンジ消尽戦略を完成（PF 1.46・勝率59.79%）
- HOLD率98.3%（取引97件/60日）が高すぎる
- 目標: PF≥1.0を維持しつつ取引数増加

### バックアップ作成

高PF設定をバックアップ:
- ファイル: `config/core/atr_based_backup_pf146.yaml`
- 内容: PF 1.46達成時のパラメータ

### 閾値調整の検証

| バージョン | 消尽率閾値 | RSI閾値 | ADX閾値 | 取引数 | PF | 評価 |
|-----------|----------|--------|--------|--------|-----|------|
| **旧（PF 1.46）** | 0.70 | 60/40 | 25 | 97件 | 1.46 | 最高PF |
| v1（過剰緩和） | 0.45 | 52/48 | 35 | 360件 | 0.91 | ❌ 赤字 |
| v2（中間） | 0.55 | 55/45 | 30 | 191件 | 0.90 | ❌ 赤字 |
| **v3（採用）** | 0.60 | 57/43 | 25 | 126件 | **1.16** | ✅ 黒字 |

### 採用設定（v3）

```yaml
strategies:
  atr_based:
    # Phase 55.1: 取引数増加版 v3
    exhaustion_threshold: 0.60       # 0.70→0.60
    high_exhaustion_threshold: 0.80  # 0.85→0.80
    adx_range_threshold: 25          # 維持
    rsi_upper: 57                    # 60→57
    rsi_lower: 43                    # 40→43
    min_confidence: 0.33             # 0.35→0.33
    base_confidence: 0.40            # 維持
    high_confidence: 0.58            # 0.60→0.58
```

### 最終結果

| 指標 | 旧設定 | v3設定 | 変化 |
|------|--------|--------|------|
| 取引数 | 97件 | **126件** | **+30%** |
| 勝率 | 59.79% | 56.35% | -3.4pt |
| PF | 1.46 | **1.16** | -20% |
| 総損益 | +31,896円 | **+13,466円** | -58% |
| HOLD率 | 98.3% | **97.8%** | -0.5pt |
| シャープレシオ | 2.89 | 1.12 | - |

### 学習事項

1. **HOLD率70%達成は困難** - 緩和するとPF < 1.0になる
2. **PF維持と取引数増加はトレードオフ** - バランスが重要
3. **微調整が最適** - 消尽率0.70→0.60、RSI 60/40→57/43程度が限界

### 次のステップ

- Phase 55.2で次の戦略（DonchianChannel or BBReversal）を見直し
- 最終的に重みづけを調整してATRレンジ消尽戦略を有効化

---

## 🔗 関連ファイル

| ファイル | 内容 |
|---------|------|
| `src/strategies/implementations/atr_based.py` | ATRレンジ消尽戦略（Phase 54.12で完全リファクタリング） |
| `config/core/thresholds.yaml` | 現在の閾値設定（v3） |
| `config/core/atr_based_backup_pf146.yaml` | 高PF設定バックアップ |
| `tests/unit/strategies/implementations/test_atr_based.py` | 22テスト全PASS |

---

## 📝 Phase 55 計画

### 戦略見直し対象

| 戦略 | 現在PF | 現在重み（tight_range） | 優先度 |
|------|--------|------------------------|--------|
| **ATRレンジ消尽** | 1.16 | 0.0（無効） | ← 55.1完了 |
| BBReversal | 1.32 | 0.40 | 維持検討 |
| MACDEMACrossover | 1.38 | 0.30 | 維持検討 |
| ADXTrendStrength | 1.01 | 0.20 | 見直し候補 |
| StochasticReversal | 0.77 | 0.10 | 見直し候補 |
| DonchianChannel | 0.89 | 0.0（無効） | 見直し候補 |

### 全体目標

- 6戦略それぞれが独自の思想で機能
- 戦略間の相関を低減
- レンジ相場でコツコツ利益を積み上げる構成

---

**📅 最終更新**: 2025年12月20日 - Phase 55.1完了
