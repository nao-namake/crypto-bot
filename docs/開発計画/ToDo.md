# 暗号資産取引Bot - 未達成タスク一覧

## 📋 このファイルの目的

**使用場面**:
- 未達成開発タスク確認
- 実装優先度の把握
- 進捗管理とタスク追跡

**ルール**:
- **未完了タスクのみ記載**（完了済み: `docs/開発履歴/Phase_47-49.md`参照）
- **実装順序**に沿って記載（Phase 50 → 51 → 53...）
- 定期的にタスク状況を更新

**🎯 2025/10/26更新**: Phase 49完了 → Phase 50（情報源多様化）から開始 ⭐最優先

---

## ✅ Phase 49完了サマリー

### Phase 49: バックテスト完全改修・証拠金維持率80%遵守（2025/10/26完了）
- TradeTracker実装（エントリー/エグジットペアリング・損益計算）
- matplotlib可視化（エクイティカーブ・損益分布・ドローダウン・価格チャート）
- バックテスト信頼性100%達成・維持率80%確実遵守
- 4層検証システム実装（Dockerfile・特徴量・戦略・モジュール）

**品質基準**: 1,065テスト100%成功・66.72%カバレッジ達成

**詳細**: `docs/開発履歴/Phase_49.md`参照

---

## 🎯 開発方針・品質基準（全Phase共通）

### KISS原則の徹底
- **少ない機能×高精度**を目指す
- 必要最小限の要素に絞る
- Phase 46のシンプル設計方針を継続

### 品質保証プロセス
1. **バックテスト必須**: 全機能追加時に効果検証
2. **段階的導入**: paper → 少額live → 本番の3段階
3. **テスト100%維持**: 新機能は必ず単体・統合テスト追加
4. **カバレッジ維持**: 66%以上を維持

### 複雑化リスク管理
- 各Phase実装後に複雑性評価
- 設定ファイル化の徹底（ハードコード禁止）
- コードレビュー強化

---

## 🔥 未達成タスク一覧（実装優先度順）

---

# ⭐ Phase 50: 情報源多様化（2週間）【最優先・基盤強化】

## 目的

**問題**: 55特徴量で固定・テクニカル指標のみ依存
**解決**: 特徴量55→70-80拡張・ML予測精度+15-25%向上
**期待効果**: すべての取引判断の精度向上・後続Phase性能向上

## 実装タスク

### Phase 50.1: マクロ経済指標統合（2-3日）⭐最優先・ゼロコスト

**実装内容**:
- [ ] 無料データソース統合（Yahoo Finance・FRED API）
- [ ] USD/JPY（ドル円）: BTC価格との相関分析
- [ ] 日経平均株価: リスクオン・オフ指標
- [ ] 米国債10年利回り: 金利環境把握
- [ ] Fear & Greed Index: 市場センチメント定量化
- [ ] 5-10特徴量追加

**品質基準**:
- データ取得エラーハンドリング実装
- 欠損値補完ロジック実装
- バックテストで効果検証

### Phase 50.2: 時間的特徴量拡張（2-3日）⭐最優先・ゼロコスト

**実装内容**:
- [ ] 曜日（月-日）: 週次取引パターン
- [ ] 時間帯（0-23時）: 日次取引パターン
- [ ] 月（1-12月）: 季節性効果
- [ ] 四半期（Q1-Q4）: 四半期効果
- [ ] 週末フラグ: 市場開閉パターン
- [ ] アジア・欧州・米国時間帯フラグ: 地域別市場影響
- [ ] 5-8特徴量追加

**実装例**:
```python
df['weekday'] = df.index.weekday   # 曜日 (0=月曜)
df['hour']    = df.index.hour      # 時間帯 (0-23)
df['month']   = df.index.month     # 月 (1-12)
df['quarter'] = df.index.quarter   # 四半期 (1-4)
```

**品質基準**:
- タイムゾーン処理の正確性確認（JST）
- Look-ahead bias防止確認

### Phase 50.3: News API統合（3-4日）⚠️中優先・月額$50-100

**実装内容**:
- [ ] CryptoCompare/Finnhub News API統合
- [ ] VADER感情分析実装
- [ ] ニュース感情スコア: 24時間平均
- [ ] ニュース数（過去24h）: 情報量測定
- [ ] ポジティブ/ネガティブニュース比率
- [ ] 重要ニュースフラグ
- [ ] 10-15特徴量追加

**品質基準**:
- API障害時のフォールバック実装
- コスト対効果をバックテストで検証
- 効果不十分なら導入見送り

### Phase 50.4: バックテスト検証・ML再学習（3-4日）

**実装内容**:
- [ ] 55特徴量 vs 70-80特徴量比較
- [ ] **ウォークフォワード検証実装**（新規追加）
- [ ] TimeSeriesSplit強化（n_splits=5継続）
- [ ] ML再学習（Optuna 50 trials）
- [ ] 過学習検証（train vs validation vs test）
- [ ] ペーパートレード検証（1週間）

**ウォークフォワード検証実装**:
```python
# ローリングウィンドウによる検証
for train_end in rolling_windows:
    train_data = data[:train_end]
    test_data = data[train_end:train_end + test_period]
    model.fit(train_data)
    predictions = model.predict(test_data)
    evaluate_performance(predictions, test_data)
```

**品質基準**:
- 汎化性能の向上確認
- F1スコア0.56-0.61 → 0.65-0.70目標
- ドローダウン悪化がないこと

### Phase 50.5: 特徴量選択・最適化（2-3日）【新規追加】

**実装内容**:
- [ ] **ミューチュアルインフォメーション分析**
- [ ] **逐次特徴量削減**（Recursive Feature Elimination）
- [ ] 相関分析・冗長性排除
- [ ] L1正則化による特徴量選択
- [ ] 最適特徴量セット決定（過学習防止）

**実装例**:
```python
from sklearn.feature_selection import mutual_info_classif, RFE
from sklearn.linear_model import LassoCV

# ミューチュアルインフォメーション
mi_scores = mutual_info_classif(X, y)
top_features = select_top_k_features(mi_scores, k=60)

# 逐次特徴量削減
rfe = RFE(estimator=model, n_features_to_select=60)
selected_features = rfe.fit_transform(X, y)
```

**品質基準**:
- 特徴量数削減（70-80 → 60-70）
- モデル精度維持または向上
- 過学習指標改善

## Phase 50期待効果

- **特徴量数**: 55 → 60-70（過学習防止のため削減）
- **ML予測精度**: +15-25%向上
- **汎化性能**: ウォークフォワード検証で確認
- **2025年最先端レベル**: マクロ・時間・センチメント統合
- **月額コスト**: 0-100ドル（Phase 50.1-50.2は無料）

## リスクと対策

**リスク**:
- 特徴量増加による過学習
- データ取得障害
- News APIコスト

**対策**:
- Phase 50.5で特徴量選択・最適化
- ウォークフォワード検証で汎化性確認
- News APIは効果検証後に判断

---

# 📈 Phase 51: 3軸マルチタイムフレーム戦略（1-2週間）【性能向上】

## 目的

**問題**: 5分間隔実行だが4h/15m足の2軸のみ
**解決**: 5分足を活用して直近市場状況を反映
**期待効果**: エントリー精度+8-15%向上

## 実装タスク

### Phase 51.1: 5分足補助指標実装（3-4日）

**実装内容**:
- [ ] DataPipeline拡張: **5分足OHLCV取得**
- [ ] 5分足分析ロジック: EMA5/10クロス・RSI
- [ ] MultiTimeframe戦略拡張: 3軸構成（4h:60%, 15m:30%, 5m:10%）
- [ ] フィルターモード実装（エントリー可否判定）
- [ ] **代替案検討**: 1時間足の効果も評価

**品質基準**:
- bitbank API 5分足取得確認
- キャッシュ戦略実装
- ノイズフィルタリング実装

### Phase 51.2: バックテスト検証（2-3日）

**実装内容**:
- [ ] **2軸 vs 3軸（5m）比較**
- [ ] **1時間足も試験的に検証**（代替案）
- [ ] ノイズ影響評価
- [ ] エントリー精度測定
- [ ] 取引回数・勝率・損益比較

**比較パターン**:
1. 現状: 4h（トレンド）+ 15m（エントリー）
2. 提案: 4h（60%）+ 15m（30%）+ 5m（10%）
3. 代替: 4h（60%）+ 15m（30%）+ 1h（10%）

**品質基準**:
- ノイズ増加が許容範囲内
- エントリー精度+5%以上向上
- ドローダウン悪化なし

### Phase 51.3: ペーパートレード検証（1-2週間）

**実装内容**:
- [ ] 実動作確認（5分足または1時間足）
- [ ] エントリータイミング精度測定
- [ ] 誤検知率測定

### Phase 51.4: 段階的ライブ適用

**実装内容**:
- [ ] 効果確認時のみ有効化
- [ ] features.yamlでトグル管理

## Phase 51期待効果

- **エントリー精度**: +8-15%向上
- **Phase 50+51複合効果**: +24-43%
- **直近変動対応**: 急激な価格変動への対応力強化

## リスクと対策

**リスク**:
- 5分足ノイズ増加
- API呼び出し増加

**対策**:
- バックテストで十分な検証
- 1時間足も代替案として検証
- features.yamlでオン・オフ切り替え可能

---

# 🔧 Phase 53: 戦略・特徴量拡張パッケージ（継続的改善）【継続的】

## 目的

**問題**: 5戦略・60-70特徴量で固定
**解決**: 継続的に戦略・特徴量を追加・評価
**期待効果**: ML精度継続向上・市場変化への適応

## 実装タスク

### Phase 53.1: 戦略追加候補（各2-3日）

**実装内容**:
- [ ] Ichimoku Cloud Strategy（一目均衡表）
- [ ] Volume Profile Strategy（出来高プロファイル）
- [ ] Elliott Wave Strategy（エリオット波動）

**品質基準**:
- 各戦略をバックテストで効果検証
- 既存5戦略との相関分析
- 統合時の複雑性評価

### Phase 53.2: オンチェーン指標追加（3-4日）【Phase 50から移動】

**実装内容**:
- [ ] ファンディングレート: 先物プレミアム
- [ ] 建玉比率（ロング/ショート比率）: 市場センチメント
- [ ] アクティブアドレス数: ネットワーク活性度
- [ ] 流動性指標: 取引所残高推移
- [ ] 5-10特徴量追加

**データソース**:
- CryptoQuant API
- Glassnode API
- 無料枠で取得可能なデータ優先

**品質基準**:
- データ品質確認
- 欠損値処理実装
- バックテストで効果検証

### Phase 53.3: モデルドリフト検知システム（4-5日）【新規追加】

**実装内容**:
- [ ] **データ分布変化検出**
- [ ] **モデル性能劣化検知**
- [ ] 自動再学習トリガー実装
- [ ] 統計的モニタリング（Kolmogorov-Smirnov検定等）
- [ ] Discord通知統合

**実装例**:
```python
from scipy.stats import ks_2samp

# データ分布変化検出
train_distribution = X_train.mean(axis=0)
current_distribution = X_current.mean(axis=0)
statistic, p_value = ks_2samp(train_distribution, current_distribution)

if p_value < 0.05:
    trigger_retraining()
    send_discord_alert("Model drift detected")
```

**品質基準**:
- モデル劣化を1週間以内に検知
- 再学習の自動トリガー実装
- 誤検知率を低く保つ

### Phase 53.4: ABテスト・継続的評価フレームワーク（1週間）【拡張】

**実装内容**:
- [ ] ABテスト実装（新旧戦略・特徴量比較）
- [ ] バックテスト自動評価
- [ ] 週次パフォーマンスレポート拡張
- [ ] シャープレシオ・ドローダウン監視強化
- [ ] 勝率・平均利益率トラッキング

**品質基準**:
- 自動化された評価プロセス
- 統計的有意性検定
- 可視化ダッシュボード

### Phase 53.5: 先進的手法研究（研究課題）【新規追加】

**研究対象**:
- [ ] RNN/LSTM: 時系列パターン学習
- [ ] CNN: 価格チャートパターン認識
- [ ] Transformer/Attention機構
- [ ] 強化学習（Reinforcement Learning）

**注意事項**:
- **小規模実験のみ**
- 複雑性・過学習リスク高い
- 効果検証後に本番導入判断
- 現在のGBDT系で十分な性能

**品質基準**:
- 実験環境での検証のみ
- 本番導入は慎重に判断
- KISS原則との両立確認

## Phase 53期待効果

- **継続的ML精度向上**: 市場変化への適応
- **モデル安定性向上**: ドリフト検知・自動再学習
- **資産別戦略最適化**: 将来のマルチアセット対応準備
- **先進技術キャッチアップ**: 研究レベルでの技術評価

## リスクと対策

**リスク**:
- 複雑化による保守性低下
- 過学習リスク増加

**対策**:
- 各追加機能をfeatures.yamlでトグル管理
- KISS原則チェックを徹底
- 効果不十分なら削除も検討

---

# 🌐 Phase 53.5: マルチアセット対応（2-3週間）【Phase 52から移動・優先度低】

## 目的

**問題**: BTC/JPY専用
**解決**: ETH/JPY・XRP/JPY・海外アルトコイン対応
**期待効果**: 収益機会+30-50%拡大

## 実装タスク

### Phase 53.5.1: アセット抽象化（3-4日）

**実装内容**:
- [ ] AssetConfigクラス実装
- [ ] unified.yaml拡張
- [ ] 資産別パラメータ管理

### Phase 53.5.2: bitbank ETH/JPY対応（3-4日）

**実装内容**:
- [ ] ETH/JPY API対応
- [ ] ETH-BTC相関係数特徴量追加
- [ ] 流動性確認

### Phase 53.5.3: bitbank XRP/JPY対応（3-4日）

**実装内容**:
- [ ] XRP/JPY API対応
- [ ] XRP-BTC相関係数特徴量追加
- [ ] 流動性確認

### Phase 53.5.4: 海外CEX/DEXマイナーアルトコイン対応（4-5日）

**実装内容**:
- [ ] 候補資産選定（SOL・AVAX・MATIC・LINK）
- [ ] BTC相関分析（相関係数0.3未満推奨）
- [ ] Binance/Uniswap API統合
- [ ] 法規制確認

### Phase 53.5.5: ポートフォリオ最適化（4-5日）

**実装内容**:
- [ ] PortfolioOptimizer実装
- [ ] Kelly基準ベース資金配分
- [ ] 相関係数考慮リスク分散

### Phase 53.5.6: 段階的ライブ適用（2-3週間）

**実装内容**:
- [ ] ペーパートレード検証（各資産1週間）
- [ ] 少額ライブ検証（各1万円・1週間）

## Phase 53.5期待効果

- **収益機会**: +30-50%拡大
- **リスク分散**: 相関係数考慮
- **Phase 50+51+53.5複合効果**: +62-116%

## リスクと対策

**リスク**:
- 複雑化リスク大
- 流動性リスク（ETH/JPY・XRP/JPY）
- 法規制リスク（海外CEX）

**対策**:
- **Phase 53完了後に実施**
- BTC/JPY専用を先に極める
- 効果不十分なら見送りも検討

## 実装判断基準

以下の条件を満たす場合のみ実装:
1. Phase 50-51-53でBTC/JPY精度が十分向上
2. システムが安定稼働（3ヶ月以上）
3. 資金規模が10万円以上
4. 流動性・法規制問題をクリア

---

# 📱 Phase 54: モバイル管理アプリ（PWA）（1-2週間）【運用改善】

## 目的

**問題**: 外出先でbotの停止・確認ができない
**解決**: スマホからbot制御可能なPWA実装
**期待効果**: 運用効率向上・緊急対応可能化

## 実装タスク

### Phase 54.1: 認証システム実装（2-3日）

**実装内容**:
- [ ] JWT認証実装
- [ ] 環境変数でパスワード管理
- [ ] Secret Manager統合

### Phase 54.2: REST API実装（2-3日）

**実装内容**:
- [ ] FastAPI実装
- [ ] エンドポイント: status/start/stop/balance/positions
- [ ] API認証・レート制限

### Phase 54.3: PWAフロントエンド実装（3-4日）

**実装内容**:
- [ ] HTML/CSS/JavaScript実装
- [ ] Material Design Lite使用
- [ ] レスポンシブデザイン
- [ ] オフライン対応

### Phase 54.4: Cloud Runデプロイ（1日）

**実装内容**:
- [ ] Dockerfile拡張
- [ ] HTTPSアクセス確認
- [ ] Cloud Run設定更新

### Phase 54.5: セキュリティ強化（1日）

**実装内容**:
- [ ] レート制限実装
- [ ] 監査ログ実装
- [ ] CORS設定

## Phase 54期待効果

- **運用効率**: 大幅向上
- **緊急対応**: 外出先から即座に停止可能
- **稼働率**: 99.9%達成

---

## 🎯 開発優先度まとめ

| 優先度 | Phase | 期間 | 効果 | リスク | 推奨 |
|--------|-------|------|------|--------|------|
| ⭐ 最優先 | Phase 50 | 2週間 | ML精度+15-25%・60-70特徴量 | 低 | **✅ 最優先実施** |
| 📈 性能向上 | Phase 51 | 1-2週間 | エントリー精度+8-15% | 中 | Phase 50後実施 |
| 🔧 継続改善 | Phase 53 | 継続的 | ML精度継続向上・ドリフト検知 | 低 | Phase 51後継続実施 |
| 🌐 拡張 | Phase 53.5 | 2-3週間 | 収益機会+30-50% | 高 | **Phase 53後・条件付き実施** |
| 📱 運用改善 | Phase 54 | 1-2週間 | 運用効率向上 | 低 | 性能向上後実施 |

## 期待される効果

- **Phase 50単独**: ML精度+15-25%
- **Phase 50+51複合**: エントリー精度+24-43%
- **Phase 50+51+53継続改善**: 長期的な精度向上維持
- **Phase 53.5（条件付き）**: 収益機会+30-50%（BTC/JPY完成後）

## 重要な設計原則

### KISS原則の徹底
- Phase 46の「デイトレード特化・シンプル設計回帰」方針を継続
- 複雑化する機能は慎重に検討
- 効果不十分なら削除も躊躇しない

### トレーリングストップについて
- **Phase 46で削除済み・再導入しない**
- デイトレード特化設計と相性が悪い
- シンプル性を優先

### マルチアセットについて
- **Phase 53完了後に実施**
- BTC/JPY専用を極めることを優先
- 実装判断は慎重に

---

**最終更新**: 2025年10月26日 - Phase 49完了・Phase 50開始準備・ChatGPTアドバイス反映
