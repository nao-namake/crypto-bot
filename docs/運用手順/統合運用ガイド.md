# 統合運用ガイド

## 📋 このファイルの目的

**使用場面**:
- バックテスト・ペーパートレードのローカル検証
- 本番デプロイ前のセットアップ・品質確認
- ML学習後の統合検証フロー実行
- 緊急時のトラブルシューティング

**ルール**:
- 実行手順とコマンドの正確性を維持
- 開発履歴・Phase完了情報は記載しない（開発履歴ドキュメント参照）
- トラブルシューティングは運用に必要な内容のみ記載
- 品質基準（テスト数・カバレッジ）は最新状態を維持

---

# 第1部: デプロイ前準備

## 🚀 デプロイ前チェックリスト（必須実行順序）

### Step 1: ML学習実行（新機能開発後必須）
```bash
# MLモデル再学習実行
python3 scripts/ml/create_ml_models.py --verbose

# 期待結果:
# ✅ 15特徴量: 完全生成・統一管理対応
# ✅ 3モデル: LightGBM・XGBoost・RandomForest アンサンブル学習
# ✅ ProductionEnsemble: models/production/保存完了
# ✅ 性能評価: F1スコア・精度・再現率・クロスバリデーション
```

### Step 2: 品質チェック実行（必須・30秒完了）
```bash
# 統一品質チェック実行
bash scripts/testing/checks.sh

# 期待結果:
# ✅ 653テスト100%成功
# ✅ 58.62%カバレッジ達成
# ✅ flake8・black・isort通過
# ✅ ML予測統合機能検証
# ✅ 統一設定管理体系検証
# ✅ MLモデル整合性確認
```

### Step 3: ペーパーテスト実行（安全性確認）
```bash
# ペーパートレード検証
bash scripts/management/run_safe.sh local paper

# 実行時間: 5-10分（数サイクル確認）
# 確認項目:
# ✅ 15特徴量生成正常
# ✅ 5戦略統合動作
# ✅ ML予測機能
# ✅ リスク管理システム
# ✅ Discord通知機能
# ✅ 統一設定管理体系動作

# 停止
bash scripts/management/run_safe.sh stop
```

### Step 4: バックテスト実行（戦略検証）
```bash
# バックテスト戦略検証（45分実行）
bash scripts/management/run_backtest.sh

# 実行時間: 10-15分（過去データ検証）
# 確認項目:
# ✅ 戦略パフォーマンス
# ✅ リスク・リターン分析
# ✅ ドローダウン評価
# ✅ 取引頻度・勝率
# ✅ 統一設定整合性

# 結果確認
ls -t logs/backtest_reports/ | head -1 | xargs cat
```

### Step 5: 最終品質確認（デプロイ直前）
```bash
# 統合品質チェック
bash scripts/testing/checks.sh

# システム総合診断
python3 scripts/testing/dev_check.py check --level standard

# 設定整合性確認
python3 scripts/testing/dev_check.py validate

# 期待結果:
# ✅ 653テスト100%維持
# ✅ 58.62%カバレッジ維持
# ✅ 統一設定管理体系正常
# ✅ MLモデル準備完了
```

### Step 6: コミット・プッシュ・デプロイ実行
```bash
# 1. 変更内容確認
git status
git diff

# 2. 変更をステージング
git add -A

# 3. コミット（feat/fix/docs等プレフィックス使用）
git commit -m "feat: 機能追加・テスト品質保証

- 変更内容の簡潔な説明
- テスト結果・カバレッジ維持確認
- 品質チェック完了

🤖 Generated with [Claude Code](https://claude.ai/code)

Co-Authored-By: Claude <noreply@anthropic.com>"

# 4. GitHub プッシュ（CI/CD自動実行）
git push origin main

# 5. デプロイ状況確認
gh run list --limit 5
gh run view --log

# 期待結果:
# ✅ CI/CD パイプライン成功
# ✅ 653テスト自動実行通過
# ✅ Cloud Run自動デプロイ成功
# ✅ 本番環境正常稼働確認
```

---

# 第2部: ペーパーテスト詳細手順

## ペーパートレード完全検証フロー
```bash
# 1. 環境準備
bash scripts/testing/checks.sh  # 品質事前確認

# 2. ペーパートレード起動
bash scripts/management/run_safe.sh local paper

# 3. リアルタイム監視（別ターミナル）
# 以下の動作を5-10分間確認:

# ✅ 検証項目チェックリスト:
# [ ] 🤖 MLモデル初期化: ProductionEnsemble読み込み成功
# [ ] 📊 15特徴量生成: ATR・EMA・RSI・MACD・BB・ZZ・RCI・Donchian・ADX等
# [ ] 🎯 5戦略実行: ATR・MochiPoy・MultiTimeframe・Donchian・ADX統合判定
# [ ] 🧠 ML予測: 信頼度35%閾値・アンサンブル予測実行
# [ ] ⚖️ リスク管理: Kelly基準・ドローダウン制限・ポジションサイジング
# [ ] 💰 取引機能: BUY/SELL判定・テイクプロフィット・ストップロス
# [ ] 📱 Discord通知: 3階層通知（Critical/Warning/Info）
# [ ] 🔧 統一設定: unified.yaml・thresholds.yaml設定適用確認
# [ ] 🛡️ エラーハンドリング: 異常時の適切な処理・ログ出力

# 4. ログ確認（期待する出力例）
# [INFO] 🤖 MLモデル初期化成功: ProductionEnsemble
# [INFO] 📊 15特徴量生成完了: 技術指標計算成功
# [INFO] 🎯 5戦略統合判定: 信頼度XX%・シグナル=HOLD/BUY/SELL
# [INFO] 💰 ペーパーモード残高: 10,000円 → XX,XXX円

# 5. 安全停止
bash scripts/management/run_safe.sh stop

# 6. 結果評価
echo "✅ ペーパーテスト完了: 全システム正常動作確認"
```

---

# 第3部: バックテスト詳細手順

## バックテスト実行スクリプト（推奨）
```bash
# 統合実行スクリプト（45分実行）
bash scripts/management/run_backtest.sh

# オプション:
# --days N        バックテスト期間（日数）[default: 180]
# --collect       データ収集のみ実行
# --skip-collect  データ収集をスキップ
# --help          ヘルプ表示

# 実行例:
bash scripts/management/run_backtest.sh                      # 180日間バックテスト実行（45分）
bash scripts/management/run_backtest.sh --days 30            # 30日間バックテスト実行（10分程度）
bash scripts/management/run_backtest.sh --collect --days 90  # 90日間データ収集のみ
bash scripts/management/run_backtest.sh --skip-collect       # データ収集スキップ（既存データ使用）
```

## バックテストデータ収集
```bash
# CSVデータ収集
python src/backtest/scripts/collect_historical_csv.py --days 180

# オプション:
# --days N           収集日数（デフォルト: 180日）
# --symbol PAIR      通貨ペア（デフォルト: BTC/JPY）
# --timeframes TF    タイムフレーム（デフォルト: 4h 15m）

# 実行例:
python src/backtest/scripts/collect_historical_csv.py --days 180
python src/backtest/scripts/collect_historical_csv.py --days 90 --symbol BTC/JPY
python src/backtest/scripts/collect_historical_csv.py --days 30 --timeframes 15m

# 期待結果（180日間）:
# ✅ 4時間足: 1,080件（100%成功率）
# ✅ 15分足: 17,271件（99.95%成功率）
# ✅ CSV保存: src/backtest/data/historical/BTC_JPY_4h.csv
# ✅ CSV保存: src/backtest/data/historical/BTC_JPY_15m.csv
```

## バックテスト戦略検証フロー
```bash
# 1. データ収集（初回のみ）
python src/backtest/scripts/collect_historical_csv.py --days 180

# 2. バックテスト実行（推奨）
bash scripts/management/run_backtest.sh

# または直接実行
BACKTEST_MODE=true python main.py --mode backtest

# 3. 実行時確認項目:
# ✅ 過去データ読み込み: CSVファイル（4h: 1,080件、15m: 17,271件）
# ✅ 特徴量事前計算: 2,825件/0秒（バッチ化）
# ✅ ML予測事前計算: 2,659件/0.3秒（バッチ化）
# ✅ 戦略バックテスト: 5戦略統合・ML予測・リスク管理適用
# ✅ パフォーマンス計算: 収益率・勝率・最大ドローダウン・取引頻度
# ✅ 価格データ正常: entry_price設定済み

# 4. 実行進捗確認（別ターミナル）
tail -f /tmp/backtest_optimized.log | grep "取引実行完了\|サイクル"

# 5. 結果確認（実行後・約45分）
# ログファイル確認
tail -100 /tmp/backtest_optimized.log

# BUY/SELL取引確認
grep "BUY\|SELL" /tmp/backtest_optimized.log | tail -20

# 価格データ確認
grep "価格: ¥" /tmp/backtest_optimized.log | tail -10

# 6. 評価基準:
# ✅ 実行時間: 45分以内
# ✅ データ品質: 価格正常（¥0でない）・BUY/SELL両方存在
# ✅ 年間収益率: 10%以上（目標）
# ✅ 最大ドローダウン: 20%以内（制限）
# ✅ 勝率: 55%以上（期待）
# ✅ 取引回数: 月100-200回範囲
# ✅ エラーゼロ: ログに異常なし
```

---

# 第4部: 環境構築・初期セットアップ

## 🛠️ 前提条件・要件

### システム要件
- **Python**: 3.13（MLライブラリ互換性最適化・GitHub Actions統一）
- **Node.js**: 18+ （GitHub CLI用）
- **Docker**: 20.10+ （コンテナ化デプロイ用）
- **Git**: 2.30+ （バージョン管理）

### 権限・アカウント要件
- **GCP Project**: Editor またはOwner権限
- **GitHub Repository**: Admin権限
- **Bitbank API**: 信用取引対応APIキー
- **Discord**: Webhook URL設定権限

### 初回セットアップ
```bash
# プロジェクトクローン
git clone <repository-url>
cd crypto-bot

# Python依存関係インストール
pip install -r requirements.txt

# 環境確認
python3 --version  # 3.13.x確認
gcloud --version    # gcloud CLI確認
docker --version    # Docker確認
gh --version        # GitHub CLI確認
```

## 🔧 GCP環境構築

### 自動環境構築（推奨）
```bash
# 統合GCP環境構築スクリプト実行
bash scripts/deployment/setup_gcp_environment.sh --full

# 対話式セットアップで以下を設定:
# - GCP Project ID設定
# - 必要なAPI有効化（Cloud Run・Artifact Registry・Secret Manager等）
# - Artifact Registryリポジトリ作成
# - サービスアカウント作成・権限付与
# - Workload Identity設定（GitHub Actions用）
# - Secret Manager設定（Bitbank API・Discord Webhook）
```

### 環境検証・設定確認
```bash
# 包括的環境検証
bash scripts/deployment/verify_gcp_setup.sh --full

# Cloud Run専用確認
bash scripts/deployment/verify_gcp_setup.sh --cloud-run-check

# GitHub Actions連携確認
bash scripts/deployment/verify_gcp_setup.sh --github-check
```

---

# 第5部: ローカル開発環境

## 🚀 実行クイックリファレンス

### 安全実行（推奨方法）

#### ペーパートレード実行
```bash
# ペーパートレード開始（プロセス重複防止・環境自動判定）
bash scripts/management/run_safe.sh local paper

# 実行状況確認（詳細表示・子プロセス確認）
bash scripts/management/run_safe.sh status

# 通常停止
bash scripts/management/run_safe.sh stop

# 強制停止（Discord通知が止まらない場合）
bash scripts/management/bot_manager.sh stop
```

#### バックテスト実行
```bash
# バックテスト開始
bash scripts/management/run_safe.sh local backtest

# 実行状況確認
bash scripts/management/run_safe.sh status

# 結果確認
ls -t logs/backtest_reports/ | head -1 | xargs cat
```

### 品質チェック（開発時必須）
```bash
# 統一品質チェック（30秒で完了）
bash scripts/testing/checks.sh

# 期待結果: ✅ 653テスト100%成功・58.62%カバレッジ通過
```

## 🎯 モード別実行・残高設定

### モード切り替え
```bash
# ペーパーモード実行（推奨・安全）
bash scripts/management/run_safe.sh local paper

# ライブモード実行（本番取引）
bash scripts/management/run_safe.sh local live

# バックテストモード実行
bash scripts/management/run_safe.sh local backtest
```

### 初期残高設定変更（10万円・50万円等）

残高変更は`config/core/unified.yaml` **1箇所のみ**で完結

```bash
# 1. unified.yamlのmode_balances設定を編集
vim config/core/unified.yaml

# 編集例（1万円→10万円への変更）:
mode_balances:
  paper:
    initial_balance: 100000.0    # 10,000 → 100,000に変更
  live:
    initial_balance: 100000.0    # 10,000 → 100,000に変更
  backtest:
    initial_balance: 100000.0    # 10,000 → 100,000に変更

# 2. 設定適用確認（品質チェック）
bash scripts/testing/checks.sh

# 3. ペーパートレードで動作確認
bash scripts/management/run_safe.sh local paper
# → ログで初期残高確認: "💰 ペーパーモード残高（mode_balances）: 100000.0円"

# 4. 停止
bash scripts/management/run_safe.sh stop
```

**重要**:
- ✅ 各ファイルの個別修正は**不要** - unified.yamlのみ修正
- ✅ paper/live/backtest全モード統一管理
- ✅ 状態ファイルは`src/core/state/{mode}/`に自動分離
- ✅ 本番環境への影響なし（モード別完全分離）

### 戦略パラメータ変更手順

戦略固有パラメータのハードコード完全排除により、戦略の数値パラメータを運用中に変更可能。

#### 戦略パラメータ変更フロー
```bash
# 1. thresholds.yamlの戦略固有設定を編集
vim config/core/thresholds.yaml

# 編集例（ATRBased戦略のパラメータ調整）:
dynamic_confidence:
  strategies:
    atr_based:
      position_size_base: 0.02              # 0.015 → 0.02（ポジションサイズ拡大）
      market_stress_threshold: 0.6          # 0.7 → 0.6（取引機会拡大）
      min_atr_ratio: 0.4                    # 0.5 → 0.4（低ボラ時取引許可）
      strength_normalize: 25.0              # 30.0 → 25.0（RSI感度向上）

# 2. 設定適用確認（品質チェック）
bash scripts/testing/checks.sh

# 3. ペーパートレードで動作確認（戦略パラメータ変更確認）
bash scripts/management/run_safe.sh local paper

# 4. 動作確認後停止
bash scripts/management/run_safe.sh stop
```

#### 変更可能パラメータ一覧

**ATRBased戦略（`dynamic_confidence.strategies.atr_based.*`）**:
- `position_size_base`: 基本ポジションサイズ（デフォルト: 0.015）
- `market_stress_threshold`: 市場ストレス閾値（デフォルト: 0.7）
- `min_atr_ratio`: 最小ATR比率（デフォルト: 0.5）
- `strength_normalize`: RSI強度正規化値（デフォルト: 30.0）
- `rsi_base`: RSI基本信頼度（デフォルト: 0.2）

**MultiTimeframe戦略（`dynamic_confidence.strategies.multi_timeframe.*`）**:
- `tf_4h_min_strength`: 4時間足最小トレンド強度（デフォルト: 0.002）
- `tf_4h_weight`: 4時間足重み（デフォルト: 0.6）
- `tf_15m_weight`: 15分足重み（デフォルト: 0.4）
- `position_size_base`: 基本ポジションサイズ（デフォルト: 0.025）
- `atr_ratio_threshold`: ATR比率閾値（デフォルト: 0.005）
- `price_breakout_ratio`: 価格ブレイクアウト比率（デフォルト: 0.995）

**変更時の注意事項**:
- ⚠️ **過度なパラメータ変更は避ける**: 元値の±20%程度の変更に留める
- ⚠️ **品質チェック必須**: 設定変更後は必ず`bash scripts/testing/checks.sh`実行
- ⚠️ **ペーパーテストで確認**: 本番前にペーパーモードで動作確認
- ✅ **リアルタイム適用**: プロセス再起動で設定値即座反映

---

# 第6部: デプロイメント

## 🚀 CI/CDパイプライン

### 自動CI/CDフロー（推奨）
```bash
# 1. ローカル品質チェック
bash scripts/testing/checks.sh

# 2. コード変更をプッシュしてCI/CD実行
git add -A
git commit -m "feat: 新機能追加"
git push origin main

# 3. デプロイ状況確認
gh run list --limit 5
gh run view --log
```

### デプロイモード制御
```bash
# ペーパートレードモード（安全・推奨）
gh secret set DEPLOY_MODE --body "paper"

# 本番取引モード
gh secret set DEPLOY_MODE --body "live"
```

---

# 第7部: 日常運用・監視

## 📊 24時間監視体制

### システム状態確認（毎日推奨）
```bash
# 統一品質チェック（30秒で完了）
bash scripts/testing/checks.sh

# システム総合診断
python3 scripts/testing/dev_check.py check --level standard

# プロセス管理状況確認（詳細表示）
bash scripts/management/run_safe.sh status

# 本番環境稼働確認
gcloud run services describe crypto-bot-service-prod --region=asia-northeast1

# 最新ログ確認
gcloud logging read "resource.type=cloud_run_revision" --limit=10

# ローカル動作確認（短時間テスト）
bash scripts/management/run_safe.sh local paper  # 2-3分実行後停止
bash scripts/management/run_safe.sh stop         # 安全停止
```

### Discord監視・アラート確認
```bash
# Discord通知履歴確認（システム分析）
python3 scripts/analytics/base_analyzer.py --discord-check

# エラーログ確認（過去24時間）
gcloud logging read 'resource.type="cloud_run_revision" AND severity>=WARNING' --limit=10
```

---

# 第8部: 緊急時対応

## 🚨 緊急度別対応時間

### Critical レベル（5分以内）
**症状**: システム完全停止・データ損失・取引機能完全停止

```bash
# 即座ロールバック
gh workflow run ci.yml --ref <安定版コミット>
gcloud run services update-traffic crypto-bot-service-prod \
  --to-revisions=<安定リビジョン>=100 \
  --region=asia-northeast1

# 緊急停止（最終手段）
gcloud run services update crypto-bot-service-prod \
  --min-instances=0 \
  --region=asia-northeast1
```

### Discord通知問題緊急対応
```bash
# Discord通知無限ループ緊急停止
bash scripts/management/bot_manager.sh stop --verbose

# システム正常化確認
bash scripts/management/run_safe.sh status

# 完全クリーンアップ（必要時）
bash scripts/management/bot_manager.sh stop
bash scripts/management/run_safe.sh cleanup
```

## 🔍 トラブルシューティング

### プロセス管理関連の問題と対処法

#### Discord通知が止まらない問題
```bash
# 完全解決手順（1分以内）
# Discord通知無限ループ緊急停止
bash scripts/management/bot_manager.sh stop

# 停止確認
bash scripts/management/run_safe.sh status
# → "プロセス停止中" 表示で完全停止成功

# 必要に応じて詳細停止
bash scripts/management/bot_manager.sh stop --verbose
```

#### 「既にプロセスが実行中です」エラー
```bash
# 解決: bot_manager.sh stop で完全停止
bash scripts/management/bot_manager.sh stop
bash scripts/management/run_safe.sh local paper  # 再実行
```

#### ドローダウン状態問題
**問題**: 「取引拒否: リスクスコア=100.0%, 理由=ドローダウン制限」

```bash
# 1. ドローダウン状態確認
cat src/core/state/drawdown_state.json 2>/dev/null || echo "状態ファイル未存在"

# 2. paused_consecutive_loss状態の場合は状態リセット
rm -f src/core/state/drawdown_state.json

# 3. ペーパートレード再起動で正常化確認
bash scripts/management/run_safe.sh local paper
```

### 診断コマンド集
```bash
# システム全体診断
python3 scripts/testing/dev_check.py full-check

# 環境診断
bash scripts/deployment/verify_gcp_setup.sh --full

# 品質診断
bash scripts/testing/checks.sh

# プロセス診断
bash scripts/management/run_safe.sh status
bash scripts/management/bot_manager.sh stop --dry-run
```

---

# 付録: スクリプトリファレンス

## 📂 scriptsディレクトリ構成

```
scripts/
├── analytics/          # システム分析基盤
│   ├── base_analyzer.py    # Cloud Runログ取得・システム監視・分析機能
│   └── README.md
├── deployment/         # デプロイメント・インフラ管理
│   ├── deploy_production.sh        # 本番環境デプロイ・段階的リリース
│   ├── docker-entrypoint.sh        # Dockerコンテナエントリポイント
│   ├── setup_gcp_environment.sh    # 統合GCP環境構築・認証管理
│   ├── verify_gcp_setup.sh         # GCP環境検証・設定確認
│   └── README.md
├── management/         # プロセス管理・安全実行システム
│   ├── run_safe.sh              # 安全実行スクリプト（プロセスグループ管理）
│   ├── bot_manager.sh           # 統合管理スクリプト（Discord通知問題完全解決）
│   └── README.md
├── ml/                 # 機械学習モデル学習・管理
│   ├── create_ml_models.py          # 15特徴量MLモデル学習
│   └── README.md
└── testing/            # 品質保証・テストシステム
    ├── checks.sh                    # 品質チェック・テスト実行（30秒完了）
    ├── dev_check.py                 # 統合開発管理CLI・システム診断
    └── README.md
```

## 🔧 主要スクリプト詳細

### プロセス管理・安全実行システム

#### `scripts/management/run_safe.sh`
安全実行スクリプト・プロセスグループ管理・詳細監視システム
```bash
# 使用例
bash scripts/management/run_safe.sh local paper     # ペーパートレード安全実行
bash scripts/management/run_safe.sh local backtest  # バックテスト安全実行
bash scripts/management/run_safe.sh gcp live        # GCP環境ライブトレード
bash scripts/management/run_safe.sh status          # 詳細プロセス状況確認
bash scripts/management/run_safe.sh stop            # プロセスグループ対応停止
bash scripts/management/run_safe.sh cleanup         # ロックファイルクリーンアップ

# 主要機能:
# - プロセスグループ管理・独立実行
# - 詳細監視（子プロセス・動作モード・経過時間表示）
# - bot_manager.sh統合提案・2段階停止システム
# - 詳細PIDファイル管理（開始時刻・モード記録）
```

#### `scripts/management/bot_manager.sh`
Discord通知停止問題完全解決・包括的強制停止スクリプト
```bash
# 使用例
bash scripts/management/bot_manager.sh stop               # 全crypto-bot関連プロセス強制停止
bash scripts/management/bot_manager.sh stop --dry-run     # 確認のみ（実際停止なし）
bash scripts/management/bot_manager.sh stop --verbose     # 詳細ログ付き実行

# 完全解決機能:
# - 3段階プロセス検索（pgrep・ps・ロックファイル）完全検出
# - プロセスグループ単位完全停止（親子プロセス一括終了）
# - 段階的終了（SIGTERM 10秒→SIGKILL 5秒）安全停止
# - 完全クリーンアップ（全ロック・PIDファイル削除）
# - macOS完全対応（bash互換性・配列処理最適化）
# - Discord通知無限ループ問題100%解決
```

## 💡 コマンド例集

### プロセス管理ワークフロー
```bash
# 推奨実行フロー（2段階停止システム）
# 1. 安全実行
bash scripts/management/run_safe.sh local paper

# 2. 状況確認（詳細表示）
bash scripts/management/run_safe.sh status

# 3. 通常停止（プロセスグループ対応）
bash scripts/management/run_safe.sh stop

# 4. 強制停止（Discord通知が止まらない場合）
bash scripts/management/bot_manager.sh stop

# 5. 完全停止確認
bash scripts/management/run_safe.sh status
```

### 緊急時対応ワークフロー（Discord通知問題）
```bash
# Discord通知無限ループ緊急対応（1分以内解決）
# Step 1: 強制停止実行
bash scripts/management/bot_manager.sh stop --verbose

# Step 2: 停止確認
bash scripts/management/run_safe.sh status

# Step 3: 完全クリーンアップ（必要時）
bash scripts/management/bot_manager.sh stop
bash scripts/management/run_safe.sh cleanup

# → 100%確実にDiscord通知停止
```

### 日常開発ワークフロー
```bash
# 1. 開発前品質確認
bash scripts/testing/checks.sh

# 2. 機能開発・テスト追加
# ...コード修正...

# 3. 開発後品質確認
bash scripts/testing/checks.sh
python3 scripts/testing/dev_check.py check --level standard

# 4. 安全実行による動作確認（短時間テスト）
bash scripts/management/run_safe.sh local paper  # 2-3分実行
bash scripts/management/run_safe.sh stop         # 安全停止

# 5. 統合確認
python3 scripts/testing/dev_check.py check --level full
```

## 📋 実行方式比較

| 実行方法 | プロセス管理 | プロセスグループ | 強制停止 | Discord問題対応 | 推奨度 |
|---------|-------------|----------------|---------|----------------|--------|
| **従来**: `python main.py` | ❌ なし | ❌ なし | ❌ 不完全 | ❌ 対応不可 | 🚫 **非推奨** |
| **run_safe.sh** | ✅ 自動 | ✅ 対応 | ✅ 基本対応 | ⚠️ 基本対応 | ✅ **推奨** |
| **bot_manager.sh stop** | ✅ 完全 | ✅ 完全対応 | ✅ 完全対応 | ✅ **完全解決** | ✅ **緊急時必須** |

---

**最終更新**: 2025年10月9日
